<!DOCTYPE html><html lang="fr"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>Cursus Honorum</title><style>*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
:root{--gold:#D4A843;--gold-light:#F0D68A;--gold-dark:#A07828;--crimson:#8B1A1A;--crimson-light:#B83030;--crimson-dark:#5C0E0E;--marble:#F5F0E8;--marble-dark:#E0D8C8;--parchment:#FDF6E3;--bronze:#CD7F32;--purple:#5B2C6F;--green:#2E7D32;--ink:#2C1810;--ink-light:#4A3728;--corrupt:#6B21A8;--corrupt-light:#9333EA;--radius:8px;--tr:0.3s ease}
html{font-size:16px;scroll-behavior:smooth}
body{font-family:Georgia,'Times New Roman',serif;background:var(--ink);color:var(--ink);min-height:100vh;overflow-x:hidden}
.screen{display:none;min-height:100vh}.screen.active{display:flex;flex-direction:column}
#title-screen,#diff-screen{background:linear-gradient(180deg,#1a0a00 0%,#3d1c0a 40%,#5c2e15 70%,#8B1A1A 100%);justify-content:center;align-items:center;text-align:center}
.title-content,.diff-content{padding:2rem;max-width:800px}
.title-laurel{font-size:4rem;margin-bottom:.5rem;filter:drop-shadow(0 0 20px rgba(212,168,67,0.4))}
.title-main{font-size:clamp(2.5rem,6vw,4.5rem);color:var(--gold);text-shadow:0 2px 10px rgba(0,0,0,0.5);font-variant:small-caps;letter-spacing:.15em;line-height:1.1;margin-bottom:.3rem}
.title-sub{font-size:clamp(1.1rem,3vw,1.6rem);color:var(--gold-light);font-style:italic;opacity:.85;margin-bottom:2.5rem}
.title-desc{color:var(--marble-dark);font-size:1rem;max-width:600px;margin:0 auto 2.5rem;line-height:1.7;opacity:.8}
.btn{display:inline-block;padding:.9rem 2.2rem;font-family:inherit;font-size:1.1rem;border:2px solid var(--gold);background:transparent;color:var(--gold);cursor:pointer;letter-spacing:.1em;font-variant:small-caps;transition:var(--tr);border-radius:var(--radius);text-transform:uppercase}
.btn:hover{background:var(--gold);color:var(--ink);box-shadow:0 0 25px rgba(212,168,67,0.3);transform:translateY(-2px)}
.btn-primary{background:var(--gold);color:var(--ink);font-weight:bold}.btn-primary:hover{background:var(--gold-light)}
.btn-crimson{border-color:var(--crimson-light);color:var(--crimson-light)}.btn-crimson:hover{background:var(--crimson);color:var(--marble)}
.btn-green{border-color:var(--green);color:var(--green)}.btn-green:hover{background:var(--green);color:white}
.btn-small{padding:.5rem 1.2rem;font-size:.9rem}.btn:disabled{opacity:.4;cursor:not-allowed;transform:none!important}
.btn-info{border-color:var(--bronze);color:var(--bronze);padding:.4rem 1rem;font-size:.85rem;border-radius:20px}.btn-info:hover{background:var(--bronze);color:white}
.btn-ready{background:var(--crimson);color:var(--marble);border-color:var(--crimson);padding:.7rem 1.8rem;font-size:1rem}.btn-ready:hover{background:var(--crimson-light)}
/* Difficulty cards */
.diff-title{color:var(--gold);font-size:clamp(1.6rem,4vw,2.2rem);font-variant:small-caps;margin-bottom:.5rem}
.diff-subtitle{color:var(--marble-dark);font-style:italic;margin-bottom:2rem;opacity:.7}
.diff-cards{display:flex;gap:2rem;flex-wrap:wrap;justify-content:center}
.diff-card{flex:1;min-width:260px;max-width:380px;background:rgba(245,240,232,0.05);border:2px solid rgba(212,168,67,0.2);border-radius:12px;padding:2rem;cursor:pointer;transition:var(--tr);text-align:center}
.diff-card:hover{border-color:var(--gold);background:rgba(212,168,67,0.08);transform:translateY(-4px);box-shadow:0 8px 30px rgba(0,0,0,0.3)}
.diff-card .diff-icon{font-size:3rem;margin-bottom:.8rem}
.diff-card h3{color:var(--gold);font-size:1.4rem;font-variant:small-caps;margin-bottom:.6rem}
.diff-card p{color:var(--marble-dark);font-size:.9rem;line-height:1.6;margin-bottom:.3rem}
.diff-card .diff-detail{margin-top:.8rem;padding-top:.8rem;border-top:1px solid rgba(212,168,67,0.15);font-size:.82rem;color:var(--gold-light)}
/* Glossary inline */
.gl{border-bottom:1.5px dotted var(--bronze);cursor:help;position:relative;color:inherit;font-weight:inherit}
.gl .glt{visibility:hidden;background:var(--ink);color:var(--marble);font-size:.78rem;line-height:1.5;padding:.5rem .7rem;border-radius:8px;position:absolute;z-index:160;width:200px;left:50%;transform:translateX(-50%);bottom:calc(100% + 6px);opacity:0;transition:opacity .2s;pointer-events:none;font-variant:normal;text-transform:none;letter-spacing:normal;font-weight:normal;text-align:left;box-shadow:0 4px 12px rgba(0,0,0,0.4)}
.gl .glt::after{content:'';position:absolute;top:100%;left:50%;transform:translateX(-50%);border:5px solid transparent;border-top-color:var(--ink)}
.gl:hover .glt{visibility:visible;opacity:1}
/* Shady */
.shady-actions{background:rgba(107,33,168,0.04);border:1px dashed rgba(107,33,168,0.2);border-radius:10px;padding:1rem;margin:1rem 0}
.shady-actions-title{font-size:.9rem;color:var(--ink-light);margin-bottom:.8rem;font-style:italic;text-align:center}
.shady-btn{display:block;width:100%;padding:.8rem 1rem;margin:.5rem 0;border:2px solid rgba(107,33,168,0.15);background:rgba(255,255,255,0.7);border-radius:8px;cursor:pointer;text-align:left;font-family:inherit;font-size:.88rem;transition:var(--tr);line-height:1.4}
.shady-btn:hover{border-color:var(--corrupt-light);background:rgba(107,33,168,0.06);transform:translateX(4px)}
.shady-btn:disabled{opacity:.35;cursor:not-allowed;transform:none!important}
.shady-btn-name{font-weight:bold;color:var(--ink)}.shady-btn-desc{font-size:.8rem;color:var(--ink-light);margin-top:.2rem}
.shady-btn-effect{font-size:.78rem;color:var(--corrupt);margin-top:.2rem;font-style:italic}
.shady-active{border-color:var(--corrupt-light)!important;background:rgba(107,33,168,0.08)!important}
.info-panel{background:rgba(212,168,67,0.08);border:1px solid rgba(212,168,67,0.25);border-radius:10px;padding:1.2rem;margin:1rem 0;font-size:.9rem;line-height:1.7;color:var(--ink-light);animation:fadeIn .3s ease}
.info-panel h4{color:var(--crimson-dark);font-variant:small-caps;margin-bottom:.5rem;font-size:1rem}
#origin-screen{background:linear-gradient(160deg,#2C1810,#3d1c0a);justify-content:center;align-items:center;padding:2rem}
.origin-title{color:var(--gold);font-size:clamp(1.8rem,4vw,2.5rem);font-variant:small-caps;text-align:center;margin-bottom:.5rem}
.origin-subtitle{color:var(--marble-dark);text-align:center;font-style:italic;margin-bottom:2rem;opacity:.7}
.origin-cards{display:flex;gap:2rem;flex-wrap:wrap;justify-content:center;max-width:900px}
.origin-card{flex:1;min-width:280px;max-width:400px;background:rgba(245,240,232,0.05);border:2px solid rgba(212,168,67,0.2);border-radius:12px;padding:2rem;cursor:pointer;transition:var(--tr);text-align:center}
.origin-card:hover{border-color:var(--gold);background:rgba(212,168,67,0.08);transform:translateY(-4px);box-shadow:0 8px 30px rgba(0,0,0,0.3)}
.origin-card.selected{border-color:var(--gold);background:rgba(212,168,67,0.12)}
.origin-icon{font-size:3.5rem;margin-bottom:1rem}
.origin-card h3{color:var(--gold);font-size:1.5rem;font-variant:small-caps;margin-bottom:.8rem}
.origin-card p{color:var(--marble-dark);font-size:.92rem;line-height:1.6;margin-bottom:.5rem}
.origin-stats{margin-top:1rem;padding-top:1rem;border-top:1px solid rgba(212,168,67,0.15)}
.origin-stat{color:var(--gold-light);font-size:.85rem;margin:.3rem 0}
.origin-confirm{margin-top:2rem;text-align:center}
#game-screen{background:var(--parchment);min-height:100vh}
.top-bar{background:linear-gradient(135deg,var(--crimson-dark),var(--crimson));color:var(--marble);padding:.8rem 1.5rem;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:.5rem;box-shadow:0 3px 10px rgba(44,24,16,0.3);position:sticky;top:0;z-index:100}
.top-bar-left{display:flex;align-items:center;gap:1rem}
.turn-badge{background:var(--gold);color:var(--ink);padding:.3rem .8rem;border-radius:20px;font-weight:bold;font-size:.85rem;font-variant:small-caps}
.player-info{font-size:.95rem}.player-rank{color:var(--gold-light);font-variant:small-caps;font-weight:bold}
.gauges-bar{background:var(--marble);padding:.7rem 1.5rem;display:flex;justify-content:center;gap:1.2rem;flex-wrap:wrap;border-bottom:2px solid var(--marble-dark)}
.gauge{display:flex;align-items:center;gap:.4rem;font-size:.85rem;position:relative;cursor:help}
.gauge-icon{font-size:1.1rem}.gauge-bar-ct{width:65px;height:10px;background:rgba(0,0,0,0.1);border-radius:5px;overflow:hidden}
.gauge-bar-fill{height:100%;border-radius:5px;transition:width .6s ease}
.gauge-value{font-weight:bold;min-width:28px;text-align:right;font-size:.8rem}
.gauge-label{font-variant:small-caps;font-size:.72rem;color:var(--ink-light)}
.g-auctoritas .gauge-bar-fill{background:var(--purple)}
.g-favor .gauge-bar-fill{background:var(--green)}
.g-pecunia .gauge-bar-fill{background:var(--gold-dark)}
.g-virtus .gauge-bar-fill{background:var(--crimson)}
.g-fortuna .gauge-bar-fill{background:var(--bronze)}
.g-corruptio .gauge-bar-fill{background:linear-gradient(90deg,var(--corrupt),#dc2626)}
.g-corruptio .gauge-value{color:var(--corrupt)}
.g-corruptio{border-left:2px solid rgba(107,33,168,0.2);padding-left:.8rem}
.tip{position:relative;cursor:help}
.tip .tiptext{visibility:hidden;background:var(--ink);color:var(--marble);font-size:.78rem;line-height:1.5;padding:.6rem .8rem;border-radius:8px;position:absolute;z-index:150;width:220px;left:50%;transform:translateX(-50%);top:calc(100% + 8px);opacity:0;transition:opacity .2s;pointer-events:none;font-variant:normal;text-transform:none;letter-spacing:normal;font-weight:normal;text-align:left;box-shadow:0 4px 15px rgba(0,0,0,0.3)}
.tip .tiptext::before{content:'';position:absolute;bottom:100%;left:50%;transform:translateX(-50%);border:6px solid transparent;border-bottom-color:var(--ink)}
.tip:hover .tiptext{visibility:visible;opacity:1}
.corrupt-warning{background:rgba(107,33,168,0.08);border:1px solid rgba(107,33,168,0.25);border-radius:8px;padding:.6rem 1rem;margin:.8rem 0;font-size:.85rem;color:var(--corrupt);text-align:center}
.cursus-bar{background:linear-gradient(90deg,var(--ink),var(--crimson-dark));padding:.6rem 1.5rem;display:flex;align-items:center;justify-content:center;overflow-x:auto}
.cursus-step{display:flex;align-items:center}
.cursus-node{display:flex;flex-direction:column;align-items:center;padding:.2rem .6rem;min-width:70px;position:relative;cursor:help}
.cursus-node .tiptext{top:auto;bottom:calc(100% + 8px);width:200px}
.cursus-node .tiptext::before{bottom:auto;top:100%;border-bottom-color:transparent;border-top-color:var(--ink)}
.cursus-dot{width:18px;height:18px;border-radius:50%;border:2px solid rgba(212,168,67,0.3);background:transparent;margin-bottom:.2rem;transition:var(--tr)}
.cursus-dot.achieved{background:var(--gold);border-color:var(--gold);box-shadow:0 0 10px rgba(212,168,67,0.5)}
.cursus-dot.current{border-color:var(--gold-light);background:var(--gold-dark);animation:pulse 2s infinite}
@keyframes pulse{0%,100%{box-shadow:0 0 5px rgba(212,168,67,0.3)}50%{box-shadow:0 0 15px rgba(212,168,67,0.6)}}
.cursus-label{color:rgba(212,168,67,0.4);font-size:.65rem;font-variant:small-caps;transition:var(--tr)}
.cursus-dot.achieved+.cursus-label,.cursus-dot.current+.cursus-label{color:var(--gold-light)}
.cursus-arrow{color:rgba(212,168,67,0.2);font-size:.8rem;margin:0 .1rem;margin-bottom:1rem}
.game-main{flex:1;max-width:900px;margin:0 auto;padding:1.5rem;width:100%}
.phase-card{background:white;border-radius:12px;padding:1.8rem;margin-bottom:1.5rem;box-shadow:0 2px 15px rgba(0,0,0,0.06);border:1px solid var(--marble-dark);animation:fadeIn .4s ease}
@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.phase-header{display:flex;align-items:center;gap:.8rem;margin-bottom:1.2rem;padding-bottom:.8rem;border-bottom:2px solid var(--marble-dark)}
.phase-icon{font-size:1.8rem}.phase-title{font-size:1.3rem;color:var(--crimson-dark);font-variant:small-caps;letter-spacing:.08em}
.phase-year{margin-left:auto;color:var(--ink-light);font-style:italic;font-size:.9rem}
.phase-text{line-height:1.75;color:var(--ink-light);margin-bottom:1.2rem;font-size:.98rem}
.phase-text strong{color:var(--ink)}
.law-card{background:linear-gradient(135deg,var(--parchment),var(--marble));border:2px solid var(--gold-dark);border-radius:10px;padding:1.5rem;margin:1rem 0}
.law-name{color:var(--crimson-dark);font-size:1.15rem;font-weight:bold;margin-bottom:.5rem}
.law-year-tag{display:inline-block;background:var(--crimson);color:var(--marble);font-size:.72rem;padding:.15rem .5rem;border-radius:10px;margin-left:.5rem;vertical-align:middle}
.law-desc{color:var(--ink-light);font-size:.92rem;line-height:1.6;margin-bottom:1rem}
.law-effects{display:grid;grid-template-columns:1fr 1fr;gap:.8rem;margin-bottom:.8rem}
.law-effect{padding:.8rem;border-radius:8px;font-size:.85rem;line-height:1.5}
.law-effect-for{background:rgba(46,125,50,0.08);border:1px solid rgba(46,125,50,0.2)}
.law-effect-against{background:rgba(139,26,26,0.06);border:1px solid rgba(139,26,26,0.15)}
.law-effect-title{font-weight:bold;font-variant:small-caps;margin-bottom:.3rem}
.law-effect-for .law-effect-title{color:var(--green)}.law-effect-against .law-effect-title{color:var(--crimson)}
.vote-buttons{display:flex;gap:.8rem;justify-content:center;margin-top:1rem;flex-wrap:wrap}
.trial-card{background:linear-gradient(135deg,#FFF5F5,#FDE8E8);border:2px solid var(--crimson);border-radius:10px;padding:1.5rem;margin:1rem 0;position:relative;overflow:hidden}
.trial-card::before{content:'';position:absolute;top:0;left:0;right:0;height:4px;background:linear-gradient(90deg,var(--crimson),var(--corrupt),var(--crimson))}
.trial-severity{display:inline-block;padding:.2rem .7rem;border-radius:12px;font-size:.75rem;font-weight:bold;margin-bottom:.8rem}
.trial-severity.moderate{background:rgba(212,168,67,0.2);color:var(--gold-dark)}
.trial-severity.severe{background:rgba(139,26,26,0.15);color:var(--crimson)}
.trial-severity.capital{background:rgba(107,33,168,0.15);color:var(--corrupt)}
.defense-options{display:flex;flex-direction:column;gap:.7rem;margin-top:1rem}
.defense-btn{padding:1rem 1.2rem;border:2px solid var(--marble-dark);background:white;border-radius:8px;cursor:pointer;text-align:left;font-family:inherit;font-size:.9rem;transition:var(--tr);line-height:1.5}
.defense-btn:hover{border-color:var(--gold);background:rgba(212,168,67,0.05);transform:translateX(5px)}
.defense-btn:disabled{opacity:.4;cursor:not-allowed;transform:none!important}
.defense-btn-title{font-weight:bold;color:var(--crimson-dark);margin-bottom:.3rem}
.defense-btn-cost{font-size:.78rem;color:var(--ink-light);font-style:italic}
.explore-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(170px,1fr));gap:1rem;margin:1rem 0}
.explore-tile{background:var(--marble);border:2px solid var(--marble-dark);border-radius:10px;padding:1.2rem;text-align:center;cursor:pointer;transition:var(--tr)}
.explore-tile:hover:not(.visited){border-color:var(--gold);transform:translateY(-3px);box-shadow:0 5px 20px rgba(0,0,0,0.1)}
.explore-tile.visited{opacity:.5;cursor:default;border-style:dashed}
.explore-tile-icon{font-size:2.2rem;margin-bottom:.5rem}
.explore-tile-name{font-size:.88rem;font-weight:bold;color:var(--crimson-dark);font-variant:small-caps;margin-bottom:.3rem}
.explore-tile-bonus{font-size:.78rem;color:var(--green)}
.modal-overlay{display:none;position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);z-index:200;justify-content:center;align-items:center;padding:1rem}
.modal-overlay.active{display:flex}
.modal{background:var(--parchment);border-radius:12px;max-width:650px;width:100%;max-height:85vh;overflow-y:auto;border:3px solid var(--gold);box-shadow:0 10px 40px rgba(0,0,0,0.4)}
.modal-header{background:linear-gradient(135deg,var(--crimson-dark),var(--crimson));color:var(--marble);padding:1.2rem 1.5rem;display:flex;justify-content:space-between;align-items:center;border-radius:9px 9px 0 0}
.modal-header h2{font-variant:small-caps;letter-spacing:.08em;font-size:1.3rem}
.modal-close{background:none;border:none;color:var(--gold-light);font-size:1.5rem;cursor:pointer;padding:.3rem}.modal-close:hover{color:white}
.modal-body{padding:1.5rem}
.modal-body h3{color:var(--crimson-dark);font-variant:small-caps;margin:1rem 0 .5rem;font-size:1.05rem}
.modal-body p{line-height:1.7;color:var(--ink-light);margin-bottom:.8rem;font-size:.93rem}
.modal-fact{background:rgba(212,168,67,0.1);border-left:4px solid var(--gold);padding:.8rem 1rem;margin:1rem 0;border-radius:0 6px 6px 0;font-style:italic;font-size:.9rem}
.modal-bonus{background:rgba(46,125,50,0.08);border:1px solid rgba(46,125,50,0.2);padding:.8rem;border-radius:8px;text-align:center;margin-top:1rem;font-weight:bold;color:var(--green)}
.event-card{background:linear-gradient(135deg,#FFF8E7,#FFF3D6);border:2px solid var(--bronze);border-radius:10px;padding:1.5rem;margin:1rem 0}
.event-icon{font-size:2rem;text-align:center;margin-bottom:.5rem}
.event-title{text-align:center;color:var(--crimson-dark);font-variant:small-caps;font-size:1.1rem;margin-bottom:.8rem}
.event-text{line-height:1.65;color:var(--ink-light);margin-bottom:1rem;text-align:center;font-size:.93rem}
.event-choices{display:flex;flex-direction:column;gap:.7rem}
.event-choice-btn{padding:.8rem 1.2rem;border:2px solid var(--marble-dark);background:white;border-radius:8px;cursor:pointer;text-align:left;font-family:inherit;font-size:.9rem;transition:var(--tr);line-height:1.5}
.event-choice-btn:hover{border-color:var(--gold);background:rgba(212,168,67,0.05);transform:translateX(5px)}
.event-choice-btn.corrupt-choice{border-color:rgba(107,33,168,0.2)}.event-choice-btn.corrupt-choice:hover{border-color:var(--corrupt);background:rgba(107,33,168,0.06)}
.event-choice-effect{font-size:.78rem;color:var(--ink-light);margin-top:.3rem;font-style:italic}
.toast-container{position:fixed;top:80px;right:1rem;z-index:300;display:flex;flex-direction:column;gap:.5rem}
.toast{background:white;border-radius:8px;padding:.8rem 1.2rem;box-shadow:0 4px 15px rgba(0,0,0,0.15);font-size:.88rem;animation:slideIn .3s ease,fadeOut .5s ease 2.5s forwards;max-width:300px;border-left:4px solid var(--gold)}
.toast.positive{border-left-color:var(--green)}.toast.negative{border-left-color:var(--crimson)}.toast.corrupt{border-left-color:var(--corrupt)}
@keyframes slideIn{from{transform:translateX(100%);opacity:0}to{transform:translateX(0);opacity:1}}
@keyframes fadeOut{to{opacity:0;transform:translateY(-10px)}}
.summary-changes{display:flex;flex-wrap:wrap;gap:.6rem;justify-content:center;margin:1rem 0}
.summary-chip{padding:.4rem .8rem;border-radius:20px;font-size:.85rem;font-weight:bold}
.summary-chip.up{background:rgba(46,125,50,0.1);color:var(--green)}.summary-chip.down{background:rgba(139,26,26,0.08);color:var(--crimson)}
.quiz-option{display:block;width:100%;padding:.8rem 1rem;margin:.4rem 0;border:2px solid var(--marble-dark);background:white;border-radius:8px;cursor:pointer;font-family:inherit;font-size:.92rem;text-align:left;transition:var(--tr)}
.quiz-option:hover:not(:disabled){border-color:var(--gold);background:rgba(212,168,67,0.05)}
.quiz-option.correct{border-color:var(--green);background:rgba(46,125,50,0.1)}
.quiz-option.wrong{border-color:var(--crimson);background:rgba(139,26,26,0.06)}
.quiz-option:disabled{cursor:default}
.quiz-explanation{margin-top:.8rem;padding:.8rem;background:rgba(212,168,67,0.08);border-radius:8px;font-size:.9rem;line-height:1.6;color:var(--ink-light)}
#end-screen{background:linear-gradient(180deg,#1a0a00,#3d1c0a 50%,#5c2e15);justify-content:center;align-items:center;text-align:center;padding:2rem}
.end-icon{font-size:5rem;margin-bottom:1rem}
.end-title{font-size:clamp(2rem,5vw,3rem);color:var(--gold);font-variant:small-caps;letter-spacing:.1em;margin-bottom:.5rem}
.end-subtitle{color:var(--gold-light);font-style:italic;font-size:1.2rem;margin-bottom:2rem}
.end-text{color:var(--marble-dark);max-width:600px;margin:0 auto 1.5rem;line-height:1.7;font-size:1rem}
.end-stats{display:flex;gap:1.5rem;justify-content:center;flex-wrap:wrap;margin:1.5rem 0 2rem}
.end-stat{background:rgba(212,168,67,0.1);border:1px solid rgba(212,168,67,0.3);border-radius:10px;padding:1rem 1.5rem;min-width:120px}
.end-stat-value{font-size:1.8rem;color:var(--gold);font-weight:bold}
.end-stat-label{color:var(--marble-dark);font-size:.8rem;font-variant:small-caps}
@media(max-width:768px){.law-effects{grid-template-columns:1fr}.explore-grid{grid-template-columns:repeat(auto-fill,minmax(140px,1fr))}.gauges-bar{gap:.6rem;padding:.5rem .8rem}.gauge-bar-ct{width:45px}.gauge-label{display:none}.cursus-node{min-width:50px}.cursus-label{font-size:.55rem}.game-main{padding:1rem}.phase-card{padding:1.2rem}.tip .tiptext,.gl .glt{width:170px;font-size:.72rem}}
</style></head><body>
<div class="toast-container" id="toast-container"></div>
<div class="modal-overlay" id="modal-overlay"><div class="modal"><div class="modal-header"><h2 id="modal-title"></h2><button class="modal-close" onclick="closeModal()">&times;</button></div><div class="modal-body" id="modal-body"></div></div></div>
<div class="screen active" id="title-screen"><div class="title-content"><div class="title-laurel">üèõÔ∏è</div><h1 class="title-main">Cursus Honorum</h1><p class="title-sub">L'Ascension de Rome</p><p class="title-desc">Incarnez un citoyen romain sous la R√©publique. Votez les lois, explorez Rome, gravissez le pouvoir. Mais la corruption est tentante, et la justice impitoyable...</p><button class="btn btn-primary" onclick="showScreen('diff-screen')">Commencer</button><div style="margin-top:1.5rem"><button class="btn btn-small" onclick="showHelp()" style="opacity:.7">üìñ R√®gles</button></div></div></div>
<div class="screen" id="diff-screen"><div class="diff-content"><h2 class="diff-title">Choisissez votre parcours</h2><p class="diff-subtitle">Les deux parcours m√®nent au m√™me jeu. Seuls les textes changent.</p><div class="diff-cards"><div class="diff-card" onclick="selectDiff('simple')"><div class="diff-icon">üåø</div><h3>Parcours D√©couverte</h3><p>Textes simples et clairs</p><p>Vocabulaire accessible</p><p>Explications avec des exemples modernes</p><div class="diff-detail">Id√©al pour d√©couvrir la R√©publique romaine</div></div><div class="diff-card" onclick="selectDiff('advanced')"><div class="diff-icon">üèõÔ∏è</div><h3>Parcours Avanc√©</h3><p>Textes historiques d√©taill√©s</p><p>Vocabulaire latin authentique</p><p>Contexte politique approfondi</p><div class="diff-detail">Pour approfondir ses connaissances</div></div></div></div></div>
<div class="screen" id="origin-screen"><div style="width:100%;max-width:900px;margin:0 auto"><h2 class="origin-title">Votre origine</h2><p class="origin-subtitle">Ce choix d√©termine votre parcours politique</p><div class="origin-cards"><div class="origin-card" id="card-patrician" onclick="selectOrigin('patrician')"><div class="origin-icon">ü¶Ö</div><h3>Patricien</h3><p>Aristocrate. Prestige et fortune, mais le peuple se m√©fie.</p><div class="origin-stats"><div class="origin-stat">üèõÔ∏è Auctoritas : 60</div><div class="origin-stat">üë• Favor : 30</div><div class="origin-stat">üè¶ Pecunia : 70</div><div class="origin-stat">‚öîÔ∏è Virtus : 40</div></div></div><div class="origin-card" id="card-plebeian" onclick="selectOrigin('plebeian')"><div class="origin-icon">‚öíÔ∏è</div><h3>Pl√©b√©ien</h3><p>Du peuple. Populaire et courageux, mais peu d'argent et de prestige.</p><div class="origin-stats"><div class="origin-stat">üèõÔ∏è Auctoritas : 30</div><div class="origin-stat">üë• Favor : 65</div><div class="origin-stat">üè¶ Pecunia : 35</div><div class="origin-stat">‚öîÔ∏è Virtus : 50</div></div></div></div><div class="origin-confirm"><button class="btn btn-primary" id="btn-start-game" disabled onclick="startGame()">Entrer dans Rome</button></div></div></div>
<div class="screen" id="game-screen"><div class="top-bar"><div class="top-bar-left"><span class="turn-badge" id="turn-badge">Tour 1/8</span><span class="player-info"><span id="player-origin-label"></span> ‚Äî <span class="player-rank" id="player-rank">Citoyen</span></span></div><div><button class="btn btn-small" onclick="showHelp()" style="border-color:var(--gold-light);color:var(--gold-light);padding:.3rem .8rem;font-size:.8rem">‚ùì</button></div></div><div class="gauges-bar" id="gauges-bar"></div><div class="cursus-bar" id="cursus-bar"></div><div class="game-main" id="game-main"></div></div>
<div class="screen" id="end-screen"><div id="end-content"></div></div>
<script>// GLOSSARY ‚Äî terms with dotted underline tooltips
var GLOSS={
  'ager publicus':"Terres conquises par Rome qui appartiennent \u00E0 l'\u00C9tat (mais que les riches occupent).",
  'auctoritas':"Prestige et autorit\u00E9 morale d'un homme politique romain.",
  'favor populi':"La popularit\u00E9 aupr\u00E8s du peuple romain.",
  'pecunia':"L'argent, la fortune personnelle.",
  'virtus':"Le courage, l'honneur militaire \u2014 qualit\u00E9 essentielle du citoyen romain.",
  'fortuna':"La chance, le destin, la faveur des dieux.",
  'corruptio':"Le niveau de corruption \u2014 actions malhon\u00EAtes accumul\u00E9es.",
  'cursus honorum':"La \u00AB carri\u00E8re des honneurs \u00BB : l'\u00E9chelle des magistratures romaines.",
  'consul':"Chef de l'\u00C9tat romain. Deux consuls \u00E9lus chaque ann\u00E9e dirigent Rome.",
  'pr\u00E9teur':"Magistrat charg\u00E9 de la justice, juste en dessous du consul.",
  '\u00E9dile':"Magistrat qui organise les jeux publics et g\u00E8re la ville.",
  'questeur':"Magistrat qui g\u00E8re les finances de l'\u00C9tat. Premier \u00E9chelon du cursus.",
  'tribun':"Magistrat sacro-saint qui prot\u00E8ge le peuple. Pouvoir de veto.",
  'tribun de la pl\u00E8be':"Magistrat sacro-saint \u00E9lu par les pl\u00E9b\u00E9iens. Son veto bloque toute d\u00E9cision.",
  'patricien':"Membre des vieilles familles nobles de Rome (aristocratie).",
  'pl\u00E9b\u00E9ien':"Citoyen du peuple, par opposition aux patriciens.",
  's\u00E9nat':"Assembl\u00E9e des anciens magistrats qui conseille et dirige Rome.",
  'comices':"Assembl\u00E9es du peuple qui votent les lois et \u00E9lisent les magistrats.",
  'pl\u00E9biscite':"Loi vot\u00E9e par l'assembl\u00E9e de la pl\u00E8be.",
  'imperium':"Pouvoir supr\u00EAme de commandement militaire et civil.",
  'auspices':"Signes divins (vol des oiseaux, \u00E9clairs) lus avant toute d\u00E9cision importante.",
  'augures':"Pr\u00EAtres sp\u00E9cialis\u00E9s dans la lecture des signes divins.",
  'pontifes':"Pr\u00EAtres qui supervisent tous les cultes religieux de Rome.",
  'veto':"Mot latin signifiant \u00AB j'interdis \u00BB. Pouvoir de bloquer une d\u00E9cision.",
  'intercessio':"Le droit de veto du tribun de la pl\u00E8be.",
  'client\u00E8le':"R\u00E9seau de clients (citoyens qui soutiennent un patron en \u00E9change de faveurs).",
  'sportula':"Distribution de nourriture ou d'argent d'un patron \u00E0 ses clients.",
  'ambitus':"Crime d'achat de votes lors des \u00E9lections.",
  'peculatus':"Crime de d\u00E9tournement de fonds publics.",
  'pax deorum':"La \u00AB paix avec les dieux \u00BB, maintenue par les rituels religieux.",
  'SPQR':"Senatus Populusque Romanus = Le S\u00E9nat et le Peuple romain.",
  'ludi':"Jeux publics (courses de chars, th\u00E9\u00E2tre, combats).",
  'fides':"La loyaut\u00E9, la parole donn\u00E9e \u2014 valeur fondamentale \u00E0 Rome.",
  'quaestio':"Tribunal permanent pour juger les crimes publics.",
  'socii':"Les alli\u00E9s italiens de Rome, qui combattent dans les l\u00E9gions sans avoir la citoyennet\u00E9.",
  'prodige':"Signe envoy\u00E9 par les dieux (foudre, tremblement, naissance monstrueuse).",
  'triomphe':"C\u00E9r\u00E9monie grandiose c\u00E9l\u00E9brant une victoire militaire majeure.",
  'centuries':"Groupes de citoyens class\u00E9s par richesse pour le vote.",
  'f\u00E9ciaux':"Pr\u00EAtres charg\u00E9s des rituels de guerre et de paix.",
  'divisores':"Agents qui distribuent de l'argent pour acheter des votes.",
  'Vestales':"Six pr\u00EAtresses qui entretiennent le feu sacr\u00E9 de Vesta."
};

// gl(text) ‚Äî wraps known glossary terms in tooltip spans
function gl(txt){
  var keys=Object.keys(GLOSS).sort(function(a,b){return b.length-a.length});
  for(var i=0;i<keys.length;i++){
    var k=keys[i],re=new RegExp('(?<![\\w\u00E0-\u00FF])'+k.replace(/[.*+?^${}()|[\]\\]/g,'\\$&')+'(?:s)?(?![\\w\u00E0-\u00FF])','gi');
    txt=txt.replace(re,function(m){return'<span class="gl">'+m+'<span class="glt">'+GLOSS[k]+'</span></span>'});
    // Prevent double-wrapping
    txt=txt.replace(/<span class="gl"><span class="gl">/g,'<span class="gl">');
  }
  return txt;
}

var G={auctoritas:{icon:'\u{1F3DB}\uFE0F',label:'Auctoritas',tip:"Votre prestige politique. Plus c'est haut, plus on vous respecte et plus vous montez en grade."},favor:{icon:'\u{1F465}',label:'Favor Populi',tip:"Votre popularit\u00E9 aupr\u00E8s du peuple. C'est lui qui vote pour vous !"},pecunia:{icon:'\u{1F3E6}',label:'Pecunia',tip:"Votre fortune. La politique co\u00FBte cher : jeux, campagnes, clients. \u00C0 z\u00E9ro = d\u00E9faite !"},virtus:{icon:'\u2694\uFE0F',label:'Virtus',tip:"Courage et honneur militaire. Se gagne par la guerre. N\u00E9cessaire pour les hauts postes."},fortuna:{icon:'\u{1F3B2}',label:'Fortuna',tip:"La faveur des dieux. \u00C0 z\u00E9ro = les dieux vous abandonnent = d\u00E9faite !"},corruptio:{icon:'\u{1F40D}',label:'Corruptio',tip:"Niveau de corruption. Au-del\u00E0 de 20 = risque de proc\u00E8s \u00E0 chaque tour !"}};
var CURSUS_TIPS={civis:"Citoyen : point de d\u00E9part. Peut voter et servir dans l'arm\u00E9e.",tribunus:"Tribun de la pl\u00E8be : prot\u00E8ge le peuple, pouvoir de VETO. Pl\u00E9b\u00E9iens seulement.",quaestor:"Questeur : g\u00E8re les finances de l'\u00C9tat. 1er \u00E9chelon officiel.",aedilis:"\u00C9dile : organise les jeux publics et g\u00E8re la ville.",praetor:"Pr\u00E9teur : juge supr\u00EAme, poss\u00E8de l'imperium.",consul:"Consul : chef de Rome ! Deux \u00E9lus par an. Le sommet !"};
var CURSUS=[{id:'civis',label:'Citoyen',req:{}},{id:'tribunus',label:'Tribun',req:{favor:50},plebeianOnly:true},{id:'quaestor',label:'Questeur',req:{auctoritas:40,pecunia:30}},{id:'aedilis',label:'\u00C9dile',req:{auctoritas:50,favor:45}},{id:'praetor',label:'Pr\u00E9teur',req:{auctoritas:65,virtus:45}},{id:'consul',label:'Consul',req:{auctoritas:80,favor:55,virtus:55}}];

// t(adv,sim) returns text based on difficulty
function t(a,s){return S.diff==='simple'?s:a}

// INTRO texts by origin x difficulty
var INTRO={
  patrician:{
    adv:'<p class="phase-text">Vous \u00EAtes n\u00E9 dans l\'une des plus anciennes familles de Rome. Votre lignage remonte aux compagnons de Romulus. Depuis l\'enfance, vous avez \u00E9t\u00E9 \u00E9duqu\u00E9 pour la vie publique : rh\u00E9torique, droit, art militaire. Le S\u00E9nat est comme une seconde maison.</p><p class="phase-text"><strong>Vos atouts :</strong> Votre nom ouvre toutes les portes. Votre auctoritas est \u00E9lev\u00E9e et votre fortune familiale (pecunia) vous permet de financer jeux et campagnes.</p><p class="phase-text"><strong>Vos d\u00E9fis :</strong> Le peuple se m\u00E9fie des aristocrates. Votre favor populi est bas. Il faudra gagner la rue sans perdre le S\u00E9nat.</p><p class="phase-text"><strong>Les dangers :</strong> La corruption est tentante. Vos moyens facilitent pots-de-vin et achats de votes. Mais la justice romaine est impitoyable.</p><p class="phase-text"><strong>Parcours :</strong> Questeur \u2192 \u00C9dile \u2192 Pr\u00E9teur \u2192 Consul.</p>',
    sim:'<p class="phase-text">\u{1F985} Vous faites partie d\'une famille riche et puissante de Rome. Tout le monde conna\u00EEt votre nom. Vous avez de l\'argent et du prestige \u2014 mais le peuple ne vous fait pas confiance.</p><p class="phase-text">\u2705 <strong>Points forts :</strong> beaucoup d\'argent et de prestige.<br>\u274C <strong>Points faibles :</strong> le peuple ne vous aime pas trop.<br>\u26A0\uFE0F <strong>Attention :</strong> avec votre argent, tricher est facile... mais dangereux !</p><p class="phase-text">\u{1F3C6} <strong>Votre but :</strong> monter les \u00E9chelons jusqu\'au poste de Consul, le chef de Rome !</p>'},
  plebeian:{
    adv:'<p class="phase-text">Vous \u00EAtes n\u00E9 dans une famille modeste du quartier de Subure. Votre p\u00E8re \u00E9tait artisan. Mais vous avez de l\'ambition \u2014 et \u00E0 Rome, le talent peut mener loin. Vous avez appris la rh\u00E9torique et fait vos preuves dans les l\u00E9gions.</p><p class="phase-text"><strong>Vos atouts :</strong> Le peuple vous fait confiance (favor \u00E9lev\u00E9). Vous pouvez acc\u00E9der au Tribunat de la pl\u00E8be \u2014 une arme redoutable avec son droit de veto.</p><p class="phase-text"><strong>Vos d\u00E9fis :</strong> Votre auctoritas est basse, les vieilles familles vous m\u00E9prisent. Et votre fortune est maigre.</p><p class="phase-text"><strong>Les dangers :</strong> Sans argent, la tentation de la corruption est immense. Les raccourcis existent, mais les proc\u00E8s guettent.</p><p class="phase-text"><strong>Parcours :</strong> Tribun \u2192 Questeur \u2192 \u00C9dile \u2192 Pr\u00E9teur \u2192 Consul.</p>',
    sim:'<p class="phase-text">\u2692\uFE0F Vous venez d\'une famille ordinaire. Pas de fortune, pas de grand nom. Mais le peuple vous aime et vous \u00EAtes courageux.</p><p class="phase-text">\u2705 <strong>Points forts :</strong> tr\u00E8s populaire, acc\u00E8s au poste de Tribun (pouvoir de bloquer les d\u00E9cisions).<br>\u274C <strong>Points faibles :</strong> peu d\'argent, peu de prestige.<br>\u26A0\uFE0F <strong>Attention :</strong> sans argent, la tentation de tricher est forte !</p><p class="phase-text">\u{1F3C6} <strong>Votre but :</strong> monter les \u00E9chelons jusqu\'au poste de Consul !</p>'}
};

var MONUMENTS=[
  {id:'forum',name:'Forum Romanum',icon:'\u{1F3DB}\uFE0F',bonus:{auctoritas:5},bonusText:'+5 Auctoritas',
    content:{adv:{desc:"Le Forum Romanum est le c\u0153ur politique, judiciaire et religieux de la R\u00E9publique. Situ\u00E9 entre le Capitole et le Palatin, il rassemble la Curie (S\u00E9nat), les Rostres (tribune), les basiliques (justice) et des temples. C'est aussi un lieu de commerce avec ses boutiques. Chaque matin, des milliers de citoyens s'y pressent pour \u00E9couter les discours et discuter politique.",history:"Am\u00E9nag\u00E9 au VIIe s. av. J.-C. apr\u00E8s l'ass\u00E8chement d'un mar\u00E9cage gr\u00E2ce \u00E0 la Cloaca Maxima."},sim:{desc:"Le Forum, c'est LE centre-ville de Rome. Imaginez une immense place o\u00F9 tout se passe : les politiciens font des discours, les juges rendent la justice, les marchands vendent leurs produits. C'est l\u00E0 que se trouve le S\u00E9nat et les tribunes d'o\u00F9 on parle au peuple.",history:"Ce lieu existe depuis 700 ans avant J\u00E9sus-Christ. Au d\u00E9but, c'\u00E9tait un mar\u00E9cage !"}},
    fact:"Les Rostres tirent leur nom des \u00E9perons (rostra) de navires ennemis captur\u00E9s en 338 av. J.-C.",pedagogy:"Le Forum combine parlement, tribunal, march\u00E9 et lieu de culte.",
    qcm:{q:"Que sont les Rostres sur le Forum ?",o:["Des statues de dieux","La tribune des orateurs, d\u00E9cor\u00E9e d'\u00E9perons de navires","Le march\u00E9 aux esclaves","L'entr\u00E9e du S\u00E9nat"],c:1,ex:"Les Rostres sont la tribune d'o\u00F9 on parle au peuple, d\u00E9cor\u00E9e d'\u00E9perons de navires captur\u00E9s."}},
  {id:'capitole',name:'Temple de Jupiter',icon:'\u26E9\uFE0F',bonus:{fortuna:8},bonusText:'+8 Fortuna',
    content:{adv:{desc:"Le temple de Jupiter Optimus Maximus se dresse au sommet du Capitole. C'est ici que les consuls pr\u00EAtent serment, que les g\u00E9n\u00E9raux d\u00E9posent leur couronne, et que les augures scrutent le ciel. Il abrite la triade capitoline : Jupiter, Junon et Minerve.",history:"Consacr\u00E9 en 509 av. J.-C., l'ann\u00E9e de la fondation de la R\u00E9publique."},sim:{desc:"C'est le temple le plus important de Rome, consacr\u00E9 \u00E0 Jupiter, le roi des dieux. Les chefs de Rome viennent y pr\u00EAter serment. Les pr\u00EAtres y observent le ciel pour savoir si les dieux sont d'accord avec leurs d\u00E9cisions.",history:"Il a \u00E9t\u00E9 construit il y a tr\u00E8s longtemps, en 509 avant J.-C."}},
    fact:"Les augures observaient le vol des oiseaux pour savoir si les dieux approuvaient une d\u00E9cision.",pedagogy:"\u00C0 Rome, religion et politique sont ins\u00E9parables. \u00AB Augure \u00BB a donn\u00E9 \u00AB inaugurer \u00BB.",
    qcm:{q:"Que font les augures au Capitole ?",o:["Ils cuisinent","Ils observent les signes des dieux","Ils gardent le tr\u00E9sor","Ils entra\u00EEnent les soldats"],c:1,ex:"Les augures lisent les signes divins (oiseaux, \u00E9clairs) pour savoir si les dieux approuvent."}},
  {id:'circus',name:'Circus Maximus',icon:'\u{1F3DF}\uFE0F',bonus:{favor:8},bonusText:'+8 Favor Populi',
    content:{adv:{desc:"Le Circus Maximus est le plus grand \u00E9difice de spectacle du monde antique. Long de 600 m, il accueille 250 000 spectateurs pour les courses de chars. Quatre \u00E9curies s'affrontent : Bleus, Verts, Rouges, Blancs. L'ambiance est \u00E9lectrique.",history:"Les courses sont financ\u00E9es par les \u00E9diles, qui y investissent des fortunes pour devenir populaires."},sim:{desc:"Imaginez le plus grand stade du monde : 250 000 personnes qui hurlent pendant des courses de chars \u00E0 toute vitesse ! C'est comme la Formule 1 de l'Antiquit\u00E9, avec 4 \u00E9quipes : les Bleus, Verts, Rouges et Blancs.",history:"Les politiciens payaient les courses de leur poche pour devenir populaires. Plus les jeux \u00E9taient impressionnants, plus on les aimait."}},
    fact:"C\u00E9sar s'est endett\u00E9 massivement en organisant des jeux pour lancer sa carri\u00E8re.",pedagogy:"\u00AB Du pain et des jeux \u00BB : les spectacles sont un outil politique.",
    qcm:{q:"Quel magistrat finance les jeux au Circus ?",o:["Le consul","Le questeur","L'\u00E9dile","Le censeur"],c:2,ex:"L'\u00E9dile organise les jeux. C'est un investissement politique \u00E9norme."}},
  {id:'curia',name:'Curie (S\u00E9nat)',icon:'\u{1F4DC}',bonus:{auctoritas:6},bonusText:'+6 Auctoritas',
    content:{adv:{desc:"La Curie est le b\u00E2timent o\u00F9 si\u00E8gent les 300 s\u00E9nateurs. Ici se d\u00E9cident guerre et paix, alliances et trahisons. Le S\u00E9nat n'\u00E9dicte pas de lois stricto sensu, mais ses avis (senatus-consultes) ont un poids tel que personne n'ose les ignorer.",history:"Les s\u00E9nateurs portaient la toge pourpre. Les anciens consuls parlaient en premier."},sim:{desc:"C'est la salle o\u00F9 se r\u00E9unissent les 300 s\u00E9nateurs, les hommes les plus puissants de Rome. C'est un peu comme le parlement : ils d\u00E9cident de la guerre, de la paix et de l'argent de l'\u00C9tat.",history:"Pour parler, il faut se lever et marcher du c\u00F4t\u00E9 \u00AB pour \u00BB ou \u00AB contre \u00BB. C'est le vote par les pieds !"}},
    fact:"S\u00E9nat vient de senex (vieillard). On peut \u00EAtre s\u00E9nateur \u00E0 vie !",pedagogy:"Le S\u00E9nat n'est pas \u00E9lu : il est compos\u00E9 d'anciens magistrats.",
    qcm:{q:"Comment devient-on s\u00E9nateur ?",o:["Par \u00E9lection","En \u00E9tant ancien magistrat","En h\u00E9ritant du titre","En payant"],c:1,ex:"Les censeurs inscrivent les anciens magistrats. Pas d'\u00E9lection directe."}},
  {id:'comitium',name:'Comitium',icon:'\u{1F5F3}\uFE0F',bonus:{favor:5,auctoritas:3},bonusText:'+5 Favor, +3 Auctoritas',
    content:{adv:{desc:"Le Comitium est l'espace o\u00F9 les assembl\u00E9es du peuple votent les lois et \u00E9lisent les magistrats. Le jour d'une \u00E9lection, les citoyens font la queue par tribus ou centuries, re\u00E7oivent une tablette et votent en passant sur un pont \u00E9troit.",history:"Trois assembl\u00E9es : centuriates (par richesse), tributes (par quartier), concile de la pl\u00E8be."},sim:{desc:"C'est l'endroit o\u00F9 les citoyens votent ! Ils font la queue, re\u00E7oivent une petite tablette et d\u00E9posent leur vote dans une urne. C'est comme un bureau de vote, mais en plein air.",history:"Au d\u00E9but, le vote n'\u00E9tait m\u00EAme pas secret ! On votait \u00E0 voix haute devant tout le monde. Le vote secret n'arrive qu'en 139 av. J.-C."}},
    fact:"Le vote \u00E0 voix haute permettait aux patrons de contr\u00F4ler les votes de leurs clients.",pedagogy:"Les riches votaient en premier et pesaient davantage. Syst\u00E8me censitaire, pas \u00E9galitaire.",
    qcm:{q:"Pourquoi les comices centuriates favorisent les riches ?",o:["Les pauvres ne votent pas","Les riches votent en premier et ont plus de centuries","Le vote est payant","Seuls les propri\u00E9taires votent"],c:1,ex:"Les riches votent en premier. Si ils sont d'accord, c'est fini avant que les pauvres ne votent."}},
  {id:'aqueduc',name:'Aqueducs',icon:'\u{1F30A}',bonus:{pecunia:5,favor:3},bonusText:'+5 Pecunia, +3 Favor',
    content:{adv:{desc:"Les aqueducs acheminent l'eau des montagnes jusqu'\u00E0 Rome. La majorit\u00E9 du trac\u00E9 est souterrain. Les ing\u00E9nieurs calculent la pente avec 1-2 m de d\u00E9nivel\u00E9 par km sur 90+ km. Rome compte 11 aqueducs, livrant 1 million de m\u00B3/jour.",history:"Le premier, l'Aqua Appia (312 av. J.-C.), est construit par le censeur Appius Claudius."},sim:{desc:"Des canaux g\u00E9ants qui transportent l'eau propre depuis les montagnes jusqu'\u00E0 la ville ! C'est comme un r\u00E9seau d'eau courante antique. La plupart passent sous terre, mais les parties visibles avec leurs grandes arches sont impressionnantes.",history:"Rome avait 11 aqueducs qui livraient autant d'eau qu'une grande ville moderne. Le premier a \u00E9t\u00E9 construit en 312 av. J.-C."}},
    fact:"L'eau parcourt 90+ km avec seulement 1-2 m de pente par km !",pedagogy:"Le censeur supervisait les grands travaux. Construire un aqueduc = gloire \u00E9ternelle.",
    qcm:{q:"Quel magistrat supervise les aqueducs ?",o:["Le pr\u00E9teur","L'\u00E9dile","Le censeur","Le tribun"],c:2,ex:"Le censeur g\u00E8re le recensement ET les grands travaux publics."}},
  {id:'via_sacra',name:'Via Sacra',icon:'\u{1F6E4}\uFE0F',bonus:{virtus:5,auctoritas:3},bonusText:'+5 Virtus, +3 Auctoritas',
    content:{adv:{desc:"La Via Sacra est le chemin des g\u00E9n\u00E9raux victorieux lors du triomphe. Le triomphateur, visage peint en rouge, v\u00EAtu de pourpre et couronn\u00E9 de laurier, d\u00E9file sur un char tir\u00E9 par quatre chevaux blancs. Devant lui, prisonniers et butin.",history:"Un esclave murmure : \u00AB Memento mori \u2014 souviens-toi que tu es mortel. \u00BB"},sim:{desc:"C'est la route la plus c\u00E9l\u00E8bre de Rome ! Quand un g\u00E9n\u00E9ral gagne une grande bataille, il d\u00E9file ici sur un char dor\u00E9 tir\u00E9 par des chevaux blancs, avec les tr\u00E9sors et les prisonniers devant lui.",history:"Un esclave se tient derri\u00E8re le g\u00E9n\u00E9ral et lui r\u00E9p\u00E8te : \u00AB Souviens-toi que tu es mortel \u00BB pour qu'il ne se prenne pas pour un dieu !"}},
    fact:"Memento mori = \u00AB Souviens-toi que tu es mortel. \u00BB",pedagogy:"Le triomphe demande 5 000+ ennemis tu\u00E9s et l'accord du S\u00E9nat.",
    qcm:{q:"Que murmure l'esclave au g\u00E9n\u00E9ral ?",o:["Ave Caesar","Memento mori (souviens-toi que tu es mortel)","Veni, vidi, vici","Gloria Romae"],c:1,ex:"L'esclave rappelle au g\u00E9n\u00E9ral qu'il reste un simple mortel malgr\u00E9 sa gloire."}},
  {id:'vesta',name:'Temple de Vesta',icon:'\u{1F525}',bonus:{fortuna:6,auctoritas:2},bonusText:'+6 Fortuna, +2 Auctoritas',
    content:{adv:{desc:"Petit temple rond au Forum abritant le feu sacr\u00E9 de Rome, qui ne doit jamais s'\u00E9teindre. Six Vestales, choisies entre 6 et 10 ans, consacrent 30 ans \u00E0 l'entretenir. Elles sont les seules femmes juridiquement ind\u00E9pendantes de Rome.",history:"Le culte remonte aux origines de Rome. Rh\u00E9a Silvia, m\u00E8re de Romulus, \u00E9tait une Vestale."},sim:{desc:"Un petit temple rond avec un feu qui br\u00FBle en permanence \u2014 il ne doit JAMAIS s'\u00E9teindre ! Les Romains croient que si le feu s'\u00E9teint, Rome est en danger. Six femmes appel\u00E9es Vestales s'en occupent pendant 30 ans.",history:"Les Vestales ont des pouvoirs incroyables : elles peuvent sauver un condamn\u00E9 \u00E0 mort juste en le croisant dans la rue. Mais si elles trahissent leur engagement, elles sont enterr\u00E9es vivantes !"}},
    fact:"Les Vestales peuvent gracier un condamn\u00E9 \u00E0 mort en le croisant.",pedagogy:"La religion romaine maintient la pax deorum. \u00AB Religion \u00BB vient de religio (scrupule rituel).",
    qcm:{q:"Quel privil\u00E8ge ont les Vestales ?",o:["Commander les arm\u00E9es","Gracier un condamn\u00E9 \u00E0 mort","\u00C9lire le roi","Le droit de veto"],c:1,ex:"Les Vestales sont sacro-saintes et peuvent sauver un condamn\u00E9 \u00E0 mort."}}
];

var LAWS=[
  {name:'Lex Agraria',year:'Loi agraire, IIIe s.',
    desc:{adv:"Un tribun de la pl\u00E8be propose de redistribuer les terres publiques (ager publicus) aux citoyens les plus pauvres. Ces terres conquises appartiennent \u00E0 l'\u00C9tat, mais les riches patriciens les occupent. Les redistribuer touche aux fortunes des puissants. Le S\u00E9nat gronde, la pl\u00E8be esp\u00E8re.",sim:"Un politicien veut prendre les terres des riches pour les donner aux pauvres. Les riches sont furieux, les pauvres applaudissent. C'est l'un des sujets les plus chauds de la politique romaine !"},
    info:{adv:"L'ager publicus est la terre conquise par Rome. En th\u00E9orie publique, en r\u00E9alit\u00E9 occup\u00E9e par les riches. Les fr\u00E8res Gracques mourront pour cette cause.",sim:"Imaginez que l'\u00C9tat poss\u00E8de des terrains \u00E9normes, mais que les familles riches les utilisent comme si c'\u00E9tait les leurs. Faut-il les reprendre pour les donner aux pauvres ?"},
    forText:"Le peuple acclame.",againstText:"Le S\u00E9nat approuve.",
    forE:{favor:12,auctoritas:-5,pecunia:-5},againstE:{favor:-10,auctoritas:8,pecunia:6},
    pMod:{f:{auctoritas:-8},a:{auctoritas:10}},plMod:{f:{favor:15},a:{favor:-15}},
    shady:[{name:"Falsifier le cadastre",desc:"Garder des terres tout en pr\u00E9tendant les redistribuer.",effect:{pecunia:12,corruptio:15},et:"+12 Pecunia, +15 Corruptio"},{name:"Intimider les arpenteurs",desc:"Menacer les g\u00E9om\u00E8tres.",effect:{pecunia:8,corruptio:10},et:"+8 Pecunia, +10 Corruptio"}]},
  {name:'Lex Ogulnia',year:'300 av. J.-C.',
    desc:{adv:"Ouvrir les coll\u00E8ges sacerdotaux (pontifes, augures) aux pl\u00E9b\u00E9iens. Or les pr\u00EAtres romains sont des politiciens : \u00EAtre augure permet de bloquer une loi en d\u00E9clarant les auspices d\u00E9favorables. Ouvrir le sacerdoce = partager un pouvoir immense.",sim:"Jusqu'ici, seuls les nobles peuvent devenir pr\u00EAtres. Or les pr\u00EAtres ont un vrai pouvoir politique : ils peuvent annuler des lois en disant que les dieux ne sont pas d'accord ! Faut-il laisser le peuple acc\u00E9der \u00E0 ces postes ?"},
    info:{adv:"Les augures et pontifes contr\u00F4lent les auspices et peuvent bloquer toute action politique.",sim:"Les pr\u00EAtres romains ne prient pas seulement : ils d\u00E9cident si les dieux approuvent les d\u00E9cisions politiques. C'est un super-pouvoir !"},
    forText:"Acc\u00E8s au sacr\u00E9 pour tous.",againstText:"Le sacr\u00E9 reste aux nobles.",
    forE:{favor:10,fortuna:6,auctoritas:-3},againstE:{favor:-8,fortuna:-4,auctoritas:6},
    pMod:{f:{auctoritas:-6},a:{}},plMod:{f:{fortuna:8,favor:12},a:{}},
    shady:[{name:"Monnayer votre vote",desc:"Promettre votre soutien aux deux camps.",effect:{pecunia:10,corruptio:12},et:"+10 Pecunia, +12 Corruptio"}]},
  {name:'Rogatio de Ludis',year:'Jeux publics',
    desc:{adv:"D\u00E9bat sur les prochains jeux au Circus Maximus. Les ludi sont l'outil politique le plus puissant pour gagner le peuple. Un \u00E9dile qui organise des courses m\u00E9morables voit sa popularit\u00E9 exploser. Mais le co\u00FBt est astronomique et l'\u00C9tat ne rembourse presque rien.",sim:"Faut-il organiser des jeux g\u00E9ants au stade (courses de chars, spectacles) ? C'est tr\u00E8s cher mais \u00E7a rend super populaire. C'est un pari : d\u00E9penser une fortune maintenant pour \u00EAtre \u00E9lu plus tard."},
    info:{adv:"Les jeux sont un investissement personnel. C\u00E9sar s'est endett\u00E9 massivement.",sim:"Imaginez payer de votre poche un concert g\u00E9ant pour 250 000 personnes. Si \u00E7a marche, tout le monde vous adore. Si \u00E7a rate, vous \u00EAtes ruin\u00E9."},
    forText:"La foule scande votre nom.",againstText:"Le peuple vous juge avare.",
    forE:{pecunia:-15,favor:15,auctoritas:3},againstE:{pecunia:5,favor:-10,auctoritas:-3},
    pMod:{f:{},a:{}},plMod:{f:{favor:18},a:{}},
    shady:[{name:"D\u00E9tourner des fonds publics",desc:"Utiliser l'argent de l'\u00C9tat.",effect:{pecunia:10,favor:5,corruptio:18},et:"+10 Pecunia, +5 Favor, +18 Corruptio"},{name:"Truquer les courses",desc:"Payer des auriges.",effect:{pecunia:8,corruptio:10},et:"+8 Pecunia, +10 Corruptio"}]},
  {name:'Senatus Consultum de Bello',year:'Guerre',
    desc:{adv:"Le S\u00E9nat d\u00E9bat d'une d\u00E9claration de guerre. Les f\u00E9ciaux ont accompli les rituels. La guerre peut rapporter gloire, butin et triomphe. Mais ce sont les citoyens-soldats qui risquent leur vie. Voter la guerre = choisir entre ambition et stabilit\u00E9.",sim:"Faut-il d\u00E9clarer la guerre \u00E0 un peuple voisin ? La guerre peut rapporter de la gloire et des tr\u00E9sors, mais les soldats meurent et les familles souffrent. Les riches d\u00E9cident, les pauvres se battent."},
    info:{adv:"La guerre est le chemin le plus rapide vers la gloire. Mais les pauvres meurent tandis que les riches d\u00E9cident.",sim:"Gagner une guerre = devenir c\u00E9l\u00E8bre et riche. Perdre = catastrophe. Et m\u00EAme si on gagne, beaucoup de gens meurent."},
    forText:"Gloire militaire.",againstText:"Paix pr\u00E9serv\u00E9e.",
    forE:{virtus:12,favor:-5,fortuna:-5},againstE:{virtus:-5,favor:8,pecunia:3},
    pMod:{f:{auctoritas:5},a:{}},plMod:{f:{},a:{favor:10}},
    shady:[{name:"D\u00E9crocher un contrat militaire",desc:"Fournir les l\u00E9gions \u00E0 prix gonfl\u00E9.",effect:{pecunia:15,corruptio:14},et:"+15 Pecunia, +14 Corruptio"}]},
  {name:'Lex Licinia',year:'367 av. J.-C.',
    desc:{adv:"La Lex Licinia propose d'ouvrir le consulat aux pl\u00E9b\u00E9iens et de limiter la possession de terres \u00E0 500 jug\u00E8res. Jusqu'ici, seuls les patriciens pouvaient \u00EAtre consuls. Ce vote reconna\u00EEt que le m\u00E9rite compte plus que la naissance.",sim:"Jusqu'\u00E0 maintenant, seuls les nobles peuvent devenir chefs de Rome (consuls). Cette loi veut permettre \u00E0 N'IMPORTE QUI de talent d'acc\u00E9der au poste supr\u00EAme. C'est une r\u00E9volution !"},
    info:{adv:"R\u00E9volution majeure. Les patriciens voient cela comme la fin de leur monde.",sim:"Imaginez qu'avant, seuls les enfants de rois pouvaient devenir pr\u00E9sidents. Cette loi dit : tout le monde peut essayer."},
    forText:"Le peuple exulte.",againstText:"Les traditions sont menac\u00E9es.",
    forE:{favor:15,auctoritas:-3,virtus:3},againstE:{favor:-12,auctoritas:10},
    pMod:{f:{auctoritas:-8},a:{auctoritas:12}},plMod:{f:{favor:18,auctoritas:5},a:{favor:-18}},
    shady:[{name:"Organiser l'ambitus",desc:"Achat massif de votes via des agents.",effect:{auctoritas:8,pecunia:-8,corruptio:20},et:"+8 Auct., -8 Pecunia, +20 Corruptio"},{name:"R\u00E9pandre des rumeurs",desc:"Calomnies sur le rival.",effect:{auctoritas:5,favor:3,corruptio:8},et:"+5 Auct., +3 Favor, +8 Corruptio"}]},
  {name:'Lex Hortensia',year:'287 av. J.-C.',
    desc:{adv:"Apr\u00E8s 200 ans de luttes, les pl\u00E9biscites auraient enfin force de loi pour TOUS. Les pl\u00E9b\u00E9iens ont d\u00FB faire plusieurs s\u00E9cessions (quitter Rome, refuser l'arm\u00E9e) pour chaque droit arrach\u00E9.",sim:"Les d\u00E9cisions vot\u00E9es par le peuple doivent-elles s'appliquer \u00E0 tout le monde, m\u00EAme aux nobles ? Jusqu'ici, les nobles pouvaient les ignorer. Le peuple s'est battu pendant 200 ans pour obtenir ce droit."},
    info:{adv:"Aboutissement de 200 ans de lutte.",sim:"Le peuple a fait la \u00AB gr\u00E8ve g\u00E9n\u00E9rale \u00BB (quitter Rome et refuser de servir dans l'arm\u00E9e) plusieurs fois pour obtenir ses droits."},
    forText:"\u00C9galit\u00E9 juridique.",againstText:"Le S\u00E9nat garde le pouvoir.",
    forE:{favor:14,auctoritas:-4,fortuna:3},againstE:{favor:-12,auctoritas:8,pecunia:3},
    pMod:{f:{auctoritas:-6},a:{}},plMod:{f:{favor:16,auctoritas:4},a:{}},
    shady:[{name:"Faire chanter un tribun",desc:"Menacer de r\u00E9v\u00E9ler ses secrets.",effect:{auctoritas:6,corruptio:16},et:"+6 Auct., +16 Corruptio"}]},
  {name:'Lex de Provinciis',year:'Provinces',
    desc:{adv:"D\u00E9bat sur la gestion des provinces. Le gouverneur y exerce les pleins pouvoirs. Officiellement, il ne doit pas s'enrichir. En r\u00E9alit\u00E9, presque tous pillent leur province. Verr\u00E8s en Sicile est l'exemple c\u00E9l\u00E8bre.",sim:"Rome conqu\u00E8re des r\u00E9gions et envoie des gouverneurs les diriger. Probl\u00E8me : les gouverneurs ont tous les pouvoirs et beaucoup en profitent pour voler. Faut-il les contr\u00F4ler ou les laisser faire ?"},
    info:{adv:"Verr\u00E8s, gouverneur de Sicile, a pill\u00E9 sa province. Cic\u00E9ron l'a accus\u00E9.",sim:"Imaginez un directeur d'\u00E9cole qui vole l'argent de la cantine. Sauf qu'ici, c'est un pays entier qui est pill\u00E9."},
    forText:"Gouvernement honn\u00EAte.",againstText:"Laisser les gouverneurs tranquilles.",
    forE:{favor:8,auctoritas:4,pecunia:-8},againstE:{favor:-6,pecunia:12,auctoritas:-3},
    pMod:{f:{},a:{pecunia:15}},plMod:{f:{favor:12},a:{}},
    shady:[{name:"N\u00E9gocier votre nomination",desc:"Obtenir une province riche.",effect:{pecunia:20,corruptio:22},et:"+20 Pecunia, +22 Corruptio"},{name:"Vendre la protection",desc:"Promettre de d\u00E9fendre les provinciaux, contre paiement.",effect:{pecunia:10,corruptio:12},et:"+10 Pecunia, +12 Corruptio"}]},
  {name:'Rogatio de Civitate',year:'Citoyennet\u00E9',
    desc:{adv:"Faut-il accorder la citoyennet\u00E9 aux alli\u00E9s italiens (socii) qui combattent dans les l\u00E9gions ? Ils fournissent la moiti\u00E9 de l'arm\u00E9e mais n'ont aucun droit. Cette injustice m\u00E8nera \u00E0 la Guerre sociale (91-88 av. J.-C.).",sim:"Des alli\u00E9s de Rome se battent et meurent pour elle, mais n'ont aucun droit : pas de vote, pas de protection. Ils en ont marre. Faut-il leur donner la citoyennet\u00E9 romaine ?"},
    info:{adv:"Les socii fournissent la moiti\u00E9 de l'arm\u00E9e sans droits politiques.",sim:"C'est comme si des soldats risquaient leur vie pour un pays qui refuse de leur donner un passeport."},
    forText:"Justice pour les alli\u00E9s.",againstText:"Garder les privil\u00E8ges.",
    forE:{virtus:8,favor:5,auctoritas:-5},againstE:{favor:-5,auctoritas:6,virtus:-3},
    pMod:{f:{},a:{}},plMod:{f:{virtus:10},a:{}},
    shady:[{name:"Vendre des certificats",desc:"Faux papiers de citoyennet\u00E9.",effect:{pecunia:18,corruptio:18},et:"+18 Pecunia, +18 Corruptio"}]}
];

var EVENTS=[
  {icon:'\u26A1',title:'Prodige au Capitole !',text:{adv:"La foudre a frapp\u00E9 le temple de Jupiter ! Les augures sont convoqu\u00E9s d'urgence.",sim:"La foudre tombe sur le temple ! Les Romains pensent que c'est un message des dieux."},info:{adv:"Les Romains prennent les prodiges tr\u00E8s au s\u00E9rieux. Ne pas r\u00E9agir = impie.",sim:"Pour les Romains, un \u00E9clair sur un temple = les dieux sont en col\u00E8re ! Il faut faire quelque chose."},choices:[{text:"Sacrifice co\u00FBteux",effect:{pecunia:-8,fortuna:10},et:'-8 Pecunia, +10 Fortuna'},{text:"Interpr\u00E9ter en votre faveur",effect:{favor:6,fortuna:-5},et:'+6 Favor, -5 Fortuna'},{text:"Soudoyer les augures",effect:{pecunia:-5,auctoritas:8,corruptio:12},et:'-5 Pecunia, +8 Auct., +12 Corruptio',shady:true}]},
  {icon:'\u{1F35E}',title:'Disette \u00E0 Rome',text:{adv:"Les r\u00E9serves de bl\u00E9 sont basses. Le peuple affam\u00E9 gronde.",sim:"Il n'y a plus assez de nourriture \u00E0 Rome. Les gens ont faim et sont en col\u00E8re."},info:{adv:"Rome d\u00E9pend du bl\u00E9 import\u00E9. P\u00E9nurie = \u00E9meutes.",sim:"Rome doit importer sa nourriture. Quand il n'y en a plus, c'est la panique."},choices:[{text:"Acheter du bl\u00E9 sur vos fonds",effect:{pecunia:-12,favor:14},et:'-12 Pecunia, +14 Favor'},{text:"Plan au S\u00E9nat",effect:{auctoritas:6,favor:3},et:'+6 Auct., +3 Favor'},{text:"D\u00E9tourner des stocks militaires",effect:{pecunia:15,favor:3,corruptio:15},et:'+15 Pecunia, +3 Favor, +15 Corruptio',shady:true}]},
  {icon:'\u{1F5E1}\uFE0F',title:'Un rival vous accuse !',text:{adv:"Accusation publique devant les comices. Votre r\u00E9putation est en jeu.",sim:"Un ennemi politique vous accuse en public ! Tout le monde vous regarde."},info:{adv:"Les proc\u00E8s publics sont un sport politique \u00E0 Rome.",sim:"Accuser quelqu'un en public, c'est une strat\u00E9gie pour d\u00E9truire la carri\u00E8re d'un rival."},choices:[{text:"Contre-attaque enflamm\u00E9e",effect:{auctoritas:5,favor:5,fortuna:-6},et:'+5 Auct., +5 Favor, -6 Fortuna'},{text:"Prouver votre int\u00E9grit\u00E9",effect:{auctoritas:8,pecunia:-3,corruptio:-5},et:'+8 Auct., -5 Corruptio'},{text:"Faire dispara\u00EEtre les preuves",effect:{corruptio:20,auctoritas:3},et:'+3 Auct., +20 Corruptio !',shady:true}]},
  {icon:'\u{1F3C6}',title:'Victoire militaire !',text:{adv:"Les l\u00E9gions triomphent ! Un g\u00E9n\u00E9ral d\u00E9file sur la Via Sacra.",sim:"L'arm\u00E9e romaine a gagn\u00E9 une grande bataille ! C'est la f\u00EAte !"},info:{adv:"Le butin appartient \u00E0 l'\u00C9tat. D\u00E9tourner du butin est ill\u00E9gal.",sim:"Le tr\u00E9sor de guerre appartient \u00E0 Rome. Mais les g\u00E9n\u00E9raux se servent souvent au passage..."},choices:[{text:"Jeux en l'honneur de la victoire",effect:{virtus:5,favor:8,pecunia:-8},et:'+5 Virtus, +8 Favor, -8 Pecunia'},{text:"Discours au S\u00E9nat",effect:{auctoritas:8,virtus:4},et:'+8 Auct., +4 Virtus'},{text:"D\u00E9tourner du butin",effect:{pecunia:20,virtus:-5,corruptio:18},et:'+20 Pecunia, -5 Virtus, +18 Corruptio',shady:true}]},
  {icon:'\u{1F91D}',title:'Alliance propos\u00E9e',text:{adv:"Une puissante famille propose un mariage politique.",sim:"Une famille riche veut unir vos familles par un mariage."},info:{adv:"Le mariage \u00E0 Rome = acte politique. C\u00E9sar a mari\u00E9 sa fille \u00E0 Pomp\u00E9e.",sim:"Se marier \u00E0 Rome, c'est surtout faire une alliance politique entre familles."},choices:[{text:"Accepter",effect:{auctoritas:10,pecunia:8,favor:-6},et:'+10 Auct., +8 Pecunia, -6 Favor'},{text:"Refuser",effect:{favor:6,auctoritas:-3},et:'+6 Favor, -3 Auct.'}]},
  {icon:'\u{1F30B}',title:'Pr\u00E9sages funestes',text:{adv:"Tremblement de terre au Latium. Le peuple est inquiet.",sim:"Tremblement de terre ! Les gens pensent que les dieux sont f\u00E2ch\u00E9s."},info:{adv:"Les Romains ne distinguent pas catastrophe et message divin.",sim:"Pour les Romains, un tremblement de terre = col\u00E8re des dieux. Il faut les calmer !"},choices:[{text:"Procession religieuse",effect:{fortuna:8,favor:5,pecunia:-5},et:'+8 Fortuna, +5 Favor, -5 Pecunia'},{text:"Rassurer le S\u00E9nat",effect:{auctoritas:6,fortuna:-8},et:'+6 Auct., -8 Fortuna'}]},
  {icon:'\u{1F4B0}',title:'H\u00E9ritage contest\u00E9',text:{adv:"Fortune l\u00E9gu\u00E9e, un h\u00E9ritier conteste.",sim:"Quelqu'un vous l\u00E8gue une fortune, mais un cousin la r\u00E9clame aussi."},info:{adv:"Falsifier un testament = crimen falsi, crime grave.",sim:"Modifier un testament, c'est un crime tr\u00E8s grave \u00E0 Rome. Mais c'est tentant quand il y a beaucoup d'argent..."},choices:[{text:"D\u00E9fendre en justice",effect:{pecunia:15,auctoritas:-4,favor:-3},et:'+15 Pecunia'},{text:"Partager g\u00E9n\u00E9reusement",effect:{pecunia:5,favor:8,auctoritas:4},et:'+8 Favor, +4 Auct.'},{text:"Falsifier le testament",effect:{pecunia:25,corruptio:16,favor:-5},et:'+25 Pecunia, +16 Corruptio',shady:true}]},
  {icon:'\u{1F4E3}',title:'R\u00E9volte des clients',text:{adv:"Vos clients se plaignent de votre soutien insuffisant.",sim:"Les gens qui vous soutiennent trouvent que vous ne les aidez pas assez."},info:{adv:"La client\u00E8le = c\u0153ur du syst\u00E8me politique romain. Perdre ses clients = perdre ses votes.",sim:"En politique romaine, vous avez des \u00AB clients \u00BB : des gens qui votent pour vous en \u00E9change de cadeaux et de protection. Si vous les n\u00E9gligez, ils vous l\u00E2chent."},choices:[{text:"Sportula g\u00E9n\u00E9reuse",effect:{pecunia:-10,favor:10,auctoritas:3},et:'-10 Pecunia, +10 Favor'},{text:"Rappeler la fides",effect:{auctoritas:5,favor:-6},et:'+5 Auct., -6 Favor'},{text:"Menacer de r\u00E9v\u00E9ler leurs dettes",effect:{auctoritas:8,favor:-3,corruptio:10},et:'+8 Auct., +10 Corruptio',shady:true}]}
];

var TRIALS=[
  {charge:"Ambitus",desc:{adv:"Accus\u00E9 d'achat de votes.",sim:"On vous accuse d'avoir pay\u00E9 des gens pour qu'ils votent pour vous."},pedagogy:{adv:"L'ambitus d\u00E9signe l'achat de votes. Des divisores distribuaient l'argent dans chaque tribu.",sim:"Acheter des votes, c'est un crime qu'on appelle ambitus. Des agents sp\u00E9ciaux distribuaient l'argent en secret."}},
  {charge:"Peculatus",desc:{adv:"D\u00E9tournement de fonds publics.",sim:"On vous accuse d'avoir vol\u00E9 de l'argent public."},pedagogy:{adv:"Peculatus = vol de biens publics. Verr\u00E8s s'exila pour fuir la condamnation.",sim:"Voler l'argent de l'\u00C9tat, c'est le peculatus. Un gouverneur c\u00E9l\u00E8bre, Verr\u00E8s, a d\u00FB s'enfuir de Rome pour \u00E9chapper \u00E0 la prison."}},
  {charge:"Repetundae",desc:{adv:"Plainte des provinciaux pour extorsion.",sim:"Les habitants d'une r\u00E9gion vous accusent de les avoir vol\u00E9s."},pedagogy:{adv:"La lex Acilia permettait aux provinciaux de porter plainte. Peine : restitution du double + infamie.",sim:"Les habitants des r\u00E9gions conquises peuvent porter plainte \u00E0 Rome si le gouverneur les vole. La punition : rendre le double !"}},
  {charge:"Maiestas",desc:{adv:"Atteinte \u00E0 la dignit\u00E9 de Rome.",sim:"On vous accuse d'avoir trahi Rome."},pedagogy:{adv:"Accusation vague et politique, arme pour \u00E9liminer des adversaires.",sim:"C'est l'accusation la plus grave et la plus vague. On peut l'utiliser contre n'importe qui pour des raisons politiques."}}
];

var QUIZ=[
  {q:"Ordre du cursus honorum ?",o:["Consul \u2192 Pr\u00E9teur \u2192 \u00C9dile","Questeur \u2192 \u00C9dile \u2192 Pr\u00E9teur \u2192 Consul","\u00C9dile \u2192 Questeur \u2192 Consul","Tribun \u2192 Consul"],c:1,ex:"Questeur, \u00C9dile, Pr\u00E9teur, Consul. Ordre ascendant."},
  {q:"Pouvoir unique du tribun ?",o:["D\u00E9clarer la guerre","Le veto","Nommer les s\u00E9nateurs","Frapper monnaie"],c:1,ex:"Le veto (intercessio) bloque toute d\u00E9cision. Le tribun est sacro-saint."},
  {q:"Qu'est-ce que l'ambitus ?",o:["Un gladiateur","L'achat de votes","Un imp\u00F4t","Une c\u00E9r\u00E9monie"],c:1,ex:"Acheter des votes = ambitus. Crime tr\u00E8s courant mais ill\u00E9gal."},
  {q:"Risque pour peculatus ?",o:["Promotion","Exil et confiscation","Avertissement","Rien"],c:1,ex:"Vol de fonds publics = amende, d\u00E9ch\u00E9ance, exil."},
  {q:"Que signifie SPQR ?",o:["Salut, Peuple et Quartiers","Le S\u00E9nat et le Peuple romain","Syst\u00E8me de Questure","S\u00E9nateurs Principaux"],c:1,ex:"Senatus Populusque Romanus = Le S\u00E9nat et le Peuple romain."},
  {q:"Pourquoi les riches votent-ils en premier ?",o:["Par hasard","Syst\u00E8me censitaire par centuries","Ils payent plus d'imp\u00F4ts","Le consul d\u00E9cide"],c:1,ex:"Syst\u00E8me censitaire : les riches votent d'abord et p\u00E8sent davantage."},
  {q:"R\u00F4le des Vestales ?",o:["Pr\u00E9dire l'avenir","Entretenir le feu sacr\u00E9","Commander l'arm\u00E9e","\u00C9lire le Pontife"],c:1,ex:"Les six Vestales entretiennent le feu sacr\u00E9 de Rome."},
  {q:"Qu'est-ce que la pax deorum ?",o:["Trait\u00E9 de paix","Paix avec les dieux par les rituels","Nom d'un temple","Fin des guerres"],c:1,ex:"L'\u00E9quilibre entre Rome et ses dieux, maintenu par les rituels."}
];

var S={origin:null,diff:'advanced',turn:1,maxTurns:8,gauges:{auctoritas:0,favor:0,pecunia:0,virtus:0,fortuna:50,corruptio:0},cursusIdx:0,visited:[],usedLaws:[],usedEvents:[],phase:'law',turnCh:{},lawsVoted:0,monsExplored:0,quizScore:0,quizTotal:0,gameOver:false,quizIdx:0,quizQs:[],trialsSurvived:0,corruptActions:0,shadyUsed:false};
function showScreen(id){document.querySelectorAll('.screen').forEach(function(s){s.classList.remove('active')});document.getElementById(id).classList.add('active');window.scrollTo(0,0)}
function selectDiff(d){S.diff=d;showScreen('origin-screen')}
function selectOrigin(o){S.origin=o;document.querySelectorAll('.origin-card').forEach(function(c){c.classList.remove('selected')});document.getElementById(o==='patrician'?'card-patrician':'card-plebeian').classList.add('selected');document.getElementById('btn-start-game').disabled=false}
function clamp(v,a,b){return Math.max(a||0,Math.min(b||100,v))}
function closeModal(){document.getElementById('modal-overlay').classList.remove('active')}
function openModal(ti,h){document.getElementById('modal-title').textContent=ti;document.getElementById('modal-body').innerHTML=h;document.getElementById('modal-overlay').classList.add('active')}
function showToast(tx,tp){var c=document.getElementById('toast-container'),d=document.createElement('div');d.className='toast '+(tp||'');d.textContent=tx;c.appendChild(d);setTimeout(function(){d.remove()},3200)}
function applyEffects(ef){var ch={};for(var k in ef){if(G[k]&&ef[k]!==0){var o=S.gauges[k];S.gauges[k]=clamp(S.gauges[k]+ef[k]);var d=S.gauges[k]-o;ch[k]=(ch[k]||0)+d;S.turnCh[k]=(S.turnCh[k]||0)+d}}updateGauges();return ch}
function fmtCh(ch){var p=[];for(var k in ch)if(ch[k]!==0)p.push(G[k].icon+' '+(ch[k]>0?'+':'')+ch[k]);return p.join('  ')}
function getRomanYear(){return(300-(S.turn-1)*5)+' av. J.-C.'}
function getTrialChance(){var c=S.gauges.corruptio;return c<20?0:c<35?.15:c<50?.3:c<70?.5:.75}
function getTrialSeverity(){var c=S.gauges.corruptio;return c<40?'moderate':c<65?'severe':'capital'}
// Text selector: picks adv or sim version
function tx(obj){if(typeof obj==='string')return obj;return S.diff==='simple'?obj.sim:obj.adv}
function updateGauges(){var h='',ks=['auctoritas','favor','pecunia','virtus','fortuna','corruptio'];for(var i=0;i<ks.length;i++){var k=ks[i],g=G[k],v=S.gauges[k];h+='<div class="gauge g-'+k+' tip"><span class="gauge-icon">'+g.icon+'</span><span class="gauge-label">'+g.label+'</span><div class="gauge-bar-ct"><div class="gauge-bar-fill" style="width:'+v+'%"></div></div><span class="gauge-value">'+v+'</span><span class="tiptext">'+g.tip+'</span></div>'}document.getElementById('gauges-bar').innerHTML=h}
function updateCursus(){var st=CURSUS.filter(function(s){return !s.plebeianOnly||S.origin==='plebeian'}),h='';for(var i=0;i<st.length;i++){var d=i<S.cursusIdx?'achieved':i===S.cursusIdx?'current':'',a=i<st.length-1?'<span class="cursus-arrow">\u2192</span>':'',tp=CURSUS_TIPS[st[i].id]||'';h+='<div class="cursus-step"><div class="cursus-node tip"><div class="cursus-dot '+d+'"></div><span class="cursus-label">'+st[i].label+'</span><span class="tiptext">'+tp+'</span></div>'+a+'</div>'}document.getElementById('cursus-bar').innerHTML=h}
function updateTopBar(){document.getElementById('turn-badge').textContent='Tour '+S.turn+'/'+S.maxTurns;document.getElementById('player-origin-label').textContent=S.origin==='patrician'?'\u{1F985} Patricien':'\u2692\uFE0F Pl\u00E9b\u00E9ien';var st=CURSUS.filter(function(s){return !s.plebeianOnly||S.origin==='plebeian'});document.getElementById('player-rank').textContent=st[S.cursusIdx]?st[S.cursusIdx].label:'Citoyen'}
function startGame(){if(S.origin==='patrician')S.gauges={auctoritas:60,favor:30,pecunia:70,virtus:40,fortuna:50,corruptio:0};else S.gauges={auctoritas:30,favor:65,pecunia:35,virtus:50,fortuna:50,corruptio:0};S.turn=1;S.cursusIdx=0;S.turnCh={};S.visited=[];S.usedLaws=[];S.usedEvents=[];S.lawsVoted=0;S.monsExplored=0;S.quizScore=0;S.gameOver=false;S.trialsSurvived=0;S.corruptActions=0;showIntro()}
function showIntro(){var key=S.origin==='patrician'?'patrician':'plebeian';var txt=tx(INTRO[key]);showScreen('game-screen');updateGauges();updateCursus();updateTopBar();document.getElementById('game-main').innerHTML='<div class="phase-card" style="max-width:750px;margin:2rem auto"><div class="phase-header"><span class="phase-icon">'+(S.origin==='patrician'?'\u{1F985}':'\u2692\uFE0F')+'</span><span class="phase-title">Votre histoire commence...</span></div>'+gl(txt)+'<div style="text-align:center;margin-top:1.5rem"><button class="btn btn-primary" onclick="startTurn()">Entrer dans l\'ar\u00E8ne politique \u2192</button></div></div>'}
function startTurn(){S.turnCh={};S.phase='law';S.shadyUsed=false;if(!checkDefeat())showLawPhase()}
function checkDefeat(){var r=null;if(S.gauges.pecunia<=0)r='Ruin\u00E9 ! Plus d\'argent.';if(S.gauges.auctoritas<=5&&S.gauges.favor<=5)r='Exil\u00E9 !';if(S.gauges.fortuna<=0)r='Les dieux vous abandonnent.';if(r){S.gameOver=true;S.defeatReason=r;showEndScreen(false,false);return true}return false}

function showLawPhase(){var m=document.getElementById('game-main'),pool=LAWS.filter(function(_,i){return S.usedLaws.indexOf(i)===-1});if(!pool.length){S.usedLaws=[];pool=LAWS.slice()}var law=pool[Math.floor(Math.random()*pool.length)],idx=LAWS.indexOf(law);S.usedLaws.push(idx);var mod=S.origin==='patrician'?law.pMod:law.plMod,fE={},aE={},k;for(k in law.forE)fE[k]=law.forE[k];for(k in law.againstE)aE[k]=law.againstE[k];if(mod){if(mod.f)for(k in mod.f)fE[k]=(fE[k]||0)+mod.f[k];if(mod.a)for(k in mod.a)aE[k]=(aE[k]||0)+mod.a[k]}var fT=[],aT=[];for(k in fE)if(fE[k]!==0&&G[k])fT.push(G[k].icon+' '+(fE[k]>0?'+':'')+fE[k]);for(k in aE)if(aE[k]!==0&&G[k])aT.push(G[k].icon+' '+(aE[k]>0?'+':'')+aE[k]);window._lawForE=fE;window._lawAgE=aE;window._lawShady=law.shady;var sh='';if(law.shady&&law.shady.length){sh='<div class="shady-actions"><div class="shady-actions-title">\u{1F910} '+(S.diff==='simple'?'Des coups louches sont possibles...':'Dans l\'ombre, certaines opportunit\u00E9s se pr\u00E9sentent...')+'</div>';for(var i=0;i<law.shady.length;i++){var s=law.shady[i];sh+='<button class="shady-btn" id="shady-'+i+'" onclick="doShady('+i+')"><div class="shady-btn-name">'+s.name+'</div><div class="shady-btn-desc">'+s.desc+'</div><div class="shady-btn-effect">'+s.et+'</div></button>'}sh+='</div>'}var w='',ch=getTrialChance();if(S.gauges.corruptio>=20)w='<div class="corrupt-warning">\u26A0\uFE0F Risque de proc\u00E8s : <strong>'+Math.round(ch*100)+'%</strong></div>';var introTxt=S.diff==='simple'?'Nouveau d\u00E9bat au Forum ! Vous pouvez tricher avant de voter... mais attention aux cons\u00E9quences.':'Les citoyens se rassemblent au Forum. Avant le vote, vous pouvez agir dans l\'ombre \u2014 mais chaque coup bas augmente le risque de proc\u00E8s.';m.innerHTML='<div class="phase-card"><div class="phase-header"><span class="phase-icon">\u2696\uFE0F</span><span class="phase-title">Phase politique</span><span class="phase-year">'+getRomanYear()+'</span></div><p class="phase-text">'+gl(introTxt)+'</p>'+w+sh+'<div class="law-card"><div class="law-name">'+law.name+' <span class="law-year-tag">'+law.year+'</span> <button class="btn-info" onclick="toggleInfo()">C\'est quoi ?</button></div><div id="law-info-panel" style="display:none" class="info-panel"><h4>\u{1F4DA} '+(S.diff==='simple'?'Explication':'Comprendre l\'enjeu')+'</h4>'+gl(tx(law.info))+'</div><p class="law-desc">'+gl(tx(law.desc))+'</p><div class="law-effects"><div class="law-effect law-effect-for"><div class="law-effect-title">\u2705 POUR</div><p>'+law.forText+'</p><p style="margin-top:.5rem;font-size:.82rem;font-weight:bold;color:var(--green)">'+fT.join(', ')+'</p></div><div class="law-effect law-effect-against"><div class="law-effect-title">\u274C CONTRE</div><p>'+law.againstText+'</p><p style="margin-top:.5rem;font-size:.82rem;font-weight:bold;color:var(--crimson)">'+aT.join(', ')+'</p></div></div><div class="vote-buttons"><button class="btn btn-green" onclick="voteLaw(\'for\')">\u{1F5F3}\uFE0F POUR</button><button class="btn btn-crimson" onclick="voteLaw(\'against\')">\u{1F5F3}\uFE0F CONTRE</button></div></div></div>'}
function toggleInfo(){var p=document.getElementById('law-info-panel');p.style.display=p.style.display==='none'?'block':'none'}
function doShady(i){if(S.shadyUsed)return;S.shadyUsed=true;S.corruptActions++;var s=window._lawShady[i],ch=applyEffects(s.effect);showToast(s.name+' ! '+fmtCh(ch),'corrupt');var b=document.querySelectorAll('.shady-btn');for(var j=0;j<b.length;j++){b[j].disabled=true;if(j===i)b[j].classList.add('shady-active')}}
function voteLaw(v){S.lawsVoted++;var ef=v==='for'?window._lawForE:window._lawAgE,ch=applyEffects(ef);showToast('Vote '+(v==='for'?'POUR':'CONTRE')+' ! '+fmtCh(ch),v==='for'?'positive':'negative');S.phase='explore';setTimeout(showExplorPhase,700)}

function showExplorPhase(){var m=document.getElementById('game-main'),ti='';for(var i=0;i<MONUMENTS.length;i++){var mo=MONUMENTS[i],vi=S.visited.indexOf(mo.id)!==-1;ti+='<div class="explore-tile'+(vi?' visited':'')+'" '+(vi?'':'onclick="exploreMon(\''+mo.id+'\')"')+'><div class="explore-tile-icon">'+mo.icon+'</div><div class="explore-tile-name">'+mo.name+'</div><div class="explore-tile-bonus">'+(vi?'\u2713 Visit\u00E9':'Bonus : '+mo.bonusText)+'</div></div>'}var expTxt=S.diff==='simple'?'<strong>Cliquez sur un lieu</strong> pour le d\u00E9couvrir. Lisez bien : un quiz vous attend pour gagner le bonus !':'<strong>Cliquez sur un monument</strong> pour le d\u00E9couvrir. Lisez attentivement : un quiz vous attend !';m.innerHTML='<div class="phase-card"><div class="phase-header"><span class="phase-icon">\u{1F3DB}\uFE0F</span><span class="phase-title">Explorer Rome</span><span class="phase-year">'+getRomanYear()+'</span></div><p class="phase-text">'+expTxt+'</p><div class="explore-grid">'+ti+'</div><div style="text-align:center;margin-top:1rem"><button class="btn btn-small" onclick="skipExplore()">Passer \u2192</button></div></div>'}
function exploreMon(id){var mo=null;for(var i=0;i<MONUMENTS.length;i++)if(MONUMENTS[i].id===id){mo=MONUMENTS[i];break}if(!mo||S.visited.indexOf(id)!==-1)return;S.visited.push(id);S.monsExplored++;window._curMon=mo;var c=mo.content;var desc=tx(c);openModal(mo.icon+' '+mo.name,gl('<p>'+desc.desc+'</p><h3>\u{1F4D6} Histoire</h3><p>'+desc.history+'</p>')+'<div class="modal-fact">\u{1F4A1} <strong>Le saviez-vous ?</strong> '+gl(mo.fact)+'</div><h3>\u{1F393} \u00C0 retenir</h3><p>'+gl(mo.pedagogy)+'</p><div style="text-align:center;margin-top:1.5rem"><button class="btn btn-ready" onclick="showMonQcm()">J\'ai tout compris ! \u{1F4DD}</button></div>')}
function showMonQcm(){var mo=window._curMon;document.getElementById('modal-body').innerHTML='<h3 style="text-align:center;margin-bottom:.5rem">\u{1F4DD} Question : '+mo.name+'</h3><p style="text-align:center;font-size:.85rem;color:var(--ink-light);margin-bottom:1rem">Bonus si correct : <strong>'+mo.bonusText+'</strong></p><p style="font-weight:bold;margin-bottom:1rem">'+mo.qcm.q+'</p><div id="mon-qcm">'+mo.qcm.o.map(function(o,i){return'<button class="quiz-option" onclick="answerMonQcm('+i+')">'+o+'</button>'}).join('')+'</div><div id="mon-qcm-result"></div>'}
function answerMonQcm(idx){var mo=window._curMon,ok=idx===mo.qcm.c;var b=document.querySelectorAll('#mon-qcm .quiz-option');for(var i=0;i<b.length;i++){b[i].disabled=true;if(i===mo.qcm.c)b[i].classList.add('correct');if(i===idx&&!ok)b[i].classList.add('wrong')}var r=document.getElementById('mon-qcm-result');if(ok){applyEffects(mo.bonus);r.innerHTML='<div class="quiz-explanation">\u2705 <strong>Correct !</strong> '+gl(mo.qcm.ex)+'</div><div class="modal-bonus">Bonus : '+mo.bonusText+'</div><div style="text-align:center;margin-top:1rem"><button class="btn btn-primary btn-small" onclick="closeModal();afterExplore()">Continuer</button></div>'}else{r.innerHTML='<div class="quiz-explanation">\u274C <strong>Incorrect.</strong> '+gl(mo.qcm.ex)+'</div><div style="background:rgba(139,26,26,0.06);border:1px solid rgba(139,26,26,0.2);padding:.8rem;border-radius:8px;text-align:center;margin-top:1rem;color:var(--crimson)">Pas de bonus cette fois !</div><div style="text-align:center;margin-top:1rem"><button class="btn btn-primary btn-small" onclick="closeModal();afterExplore()">Continuer</button></div>'}}
function afterExplore(){S.phase='event';showEventPhase()}
function skipExplore(){S.phase='event';showEventPhase()}

function showEventPhase(){if(Math.random()>.7){checkTrialPhase();return}var pool=EVENTS.filter(function(_,i){return S.usedEvents.indexOf(i)===-1});if(!pool.length){S.usedEvents=[];pool=EVENTS.slice()}var ev=pool[Math.floor(Math.random()*pool.length)],idx=EVENTS.indexOf(ev);S.usedEvents.push(idx);var ch='';for(var i=0;i<ev.choices.length;i++){var c=ev.choices[i];ch+='<button class="event-choice-btn'+(c.shady?' corrupt-choice':'')+'" onclick="resolveEvent('+idx+','+i+')">'+c.text+'<div class="event-choice-effect">'+c.et+'</div></button>'}var ib=ev.info?' <button class="btn-info" onclick="document.getElementById(\'ei\').style.display=document.getElementById(\'ei\').style.display===\'none\'?\'block\':\'none\'">C\'est quoi ?</button>':'',ip=ev.info?'<div id="ei" style="display:none" class="info-panel"><h4>\u{1F4DA} '+(S.diff==='simple'?'Explication':'Contexte')+'</h4>'+gl(tx(ev.info))+'</div>':'';document.getElementById('game-main').innerHTML='<div class="phase-card"><div class="phase-header"><span class="phase-icon">\u{1F3B2}</span><span class="phase-title">\u00C9v\u00E9nement</span><span class="phase-year">'+getRomanYear()+'</span></div><div class="event-card"><div class="event-icon">'+ev.icon+'</div><div class="event-title">'+ev.title+ib+'</div>'+ip+'<p class="event-text">'+gl(tx(ev.text))+'</p><div class="event-choices">'+ch+'</div></div></div>'}
function resolveEvent(e,c){var ev=EVENTS[e],ch=applyEffects(ev.choices[c].effect);if(ev.choices[c].shady)S.corruptActions++;var s=0;for(var k in ch)s+=ch[k];showToast(ev.title+' \u2014 '+fmtCh(ch),ev.choices[c].shady?'corrupt':s>=0?'positive':'negative');setTimeout(checkTrialPhase,700)}
function checkTrialPhase(){var c=getTrialChance();if(c>0&&Math.random()<c){showTrialPhase();return}goToPromotion()}
function showTrialPhase(){var sev=getTrialSeverity(),ti=sev==='moderate'?Math.floor(Math.random()*2):sev==='severe'?2:3,trial=TRIALS[ti],sl=sev==='moderate'?'Proc\u00E8s ordinaire':sev==='severe'?'Accusation grave':'Proc\u00E8s capital';var ds=[];
ds.push({t:'Engager un avocat',d:S.diff==='simple'?"Payer un bon avocat pour vous d\u00E9fendre.":"Co\u00FBteux mais efficace.",c:'-15 Pecunia',ok:S.gauges.pecunia>=15,fn:function(){applyEffects({pecunia:-15});if(sev==='moderate'||Math.random()<.7){applyEffects({corruptio:-10,auctoritas:3});showToast('Acquitt\u00E9 !','positive');S.trialsSurvived++;setTimeout(goToPromotion,800)}else{applyEffects({corruptio:-5,auctoritas:-10,pecunia:-10});showToast('Condamn\u00E9 !','negative');setTimeout(function(){if(!checkDefeat())goToPromotion()},800)}}});
ds.push({t:'Pression sur les juges',d:S.diff==='simple'?"Essayer d'intimider les juges. Tr\u00E8s risqu\u00E9 !":"Risqu\u00E9 : si \u00E7a \u00E9choue, scandale.",c:'Auct. \u2265 50',ok:S.gauges.auctoritas>=50,fn:function(){if(Math.random()<.55){applyEffects({corruptio:8,auctoritas:-5});showToast('Juges intimid\u00E9s !','corrupt');S.trialsSurvived++;S.corruptActions++;setTimeout(goToPromotion,800)}else{applyEffects({corruptio:10,auctoritas:-20,favor:-10});showToast('Scandale !','negative');setTimeout(function(){if(!checkDefeat())goToPromotion()},800)}}});
ds.push({t:'Plaider coupable',d:S.diff==='simple'?"Avouer. Vous perdez du prestige mais vous survivez.":"Avouer pour obtenir la cl\u00E9mence.",c:'Gratuit',ok:true,fn:function(){var p=sev==='moderate'?{auctoritas:-8,corruptio:-15,favor:5}:sev==='severe'?{auctoritas:-15,corruptio:-20,pecunia:-10,favor:3}:{auctoritas:-20,corruptio:-25,pecunia:-15};applyEffects(p);S.trialsSurvived++;showToast('Condamn\u00E9 avec cl\u00E9mence.','negative');setTimeout(function(){if(!checkDefeat())goToPromotion()},800)}});
if(sev==='capital')ds.push({t:'Fuir en exil',d:S.diff==='simple'?"S'enfuir de Rome. Fin de la partie !":"Comme Verr\u00E8s. Fin de partie.",c:'GAME OVER',ok:true,fn:function(){S.gameOver=true;S.defeatReason="Fuite en exil.";showEndScreen(false,false)}});
window._ds=ds;var dh='';for(var i=0;i<ds.length;i++){var d=ds[i];dh+='<button class="defense-btn" '+(d.ok?'onclick="window._ds['+i+'].fn()"':'disabled')+'><div class="defense-btn-title">'+d.t+'</div><div class="defense-btn-cost">'+d.c+'</div><div style="font-size:.85rem;color:var(--ink-light);margin-top:.3rem">'+d.d+'</div></button>'}
document.getElementById('game-main').innerHTML='<div class="phase-card"><div class="phase-header"><span class="phase-icon">\u2696\uFE0F</span><span class="phase-title">PROC\u00C8S !</span><span class="phase-year">'+getRomanYear()+'</span></div><div class="trial-card"><span class="trial-severity '+sev+'">'+sl+'</span><h3 style="color:var(--crimson-dark);font-size:1.15rem;margin-bottom:.8rem">'+trial.charge+'</h3><p style="line-height:1.65;color:var(--ink-light)">'+gl(tx(trial.desc))+'</p><div class="modal-fact" style="margin:1rem 0">\u{1F393} '+gl(tx(trial.pedagogy))+'</div><h3 style="color:var(--crimson-dark);margin-top:1rem">'+(S.diff==='simple'?'Que faites-vous ?':'Votre d\u00E9fense :')+'</h3><div class="defense-options">'+dh+'</div></div></div>'}
function goToPromotion(){S.phase='promotion';var st=CURSUS.filter(function(s){return !s.plebeianOnly||S.origin==='plebeian'}),pr=false;while(S.cursusIdx<st.length-1){var nx=st[S.cursusIdx+1],ok=true;for(var k in nx.req)if((S.gauges[k]||0)<nx.req[k]){ok=false;break}if(ok){S.cursusIdx++;pr=true}else break}if(pr){updateCursus();updateTopBar();showToast('\u{1F389} Promotion : '+st[S.cursusIdx].label+' !','positive');if(st[S.cursusIdx].id==='consul'){setTimeout(function(){showEndScreen(true,false)},1000);return}}setTimeout(showTurnSummary,pr?1000:300)}
function showTurnSummary(){var ch='';for(var k in S.turnCh)if(S.turnCh[k]!==0)ch+='<span class="summary-chip '+(S.turnCh[k]>0?'up':'down')+'">'+G[k].icon+' '+(S.turnCh[k]>0?'+':'')+S.turnCh[k]+' '+G[k].label+'</span>';if(!ch)ch='<span style="color:var(--ink-light);font-style:italic">Aucun changement</span>';var st=CURSUS.filter(function(s){return !s.plebeianOnly||S.origin==='plebeian'}),nr='';if(S.cursusIdx<st.length-1){var nx=st[S.cursusIdx+1],rs=[];for(var k in nx.req){var c=S.gauges[k],n=nx.req[k],o=c>=n;rs.push('<span style="color:'+(o?'var(--green)':'var(--crimson)')+'">'+G[k].icon+' '+c+'/'+n+(o?' \u2713':' \u2717')+'</span>')}nr='<p style="margin-top:1rem;font-size:.9rem;color:var(--ink-light)">'+(S.diff==='simple'?'Prochain poste':'Prochaine \u00E9tape')+' : <strong>'+nx.label+'</strong><br>'+rs.join(' | ')+'</p>'}var w='';if(S.gauges.corruptio>=20)w='<div class="corrupt-warning" style="margin-top:1rem">\u{1F40D} Corruptio : '+S.gauges.corruptio+' \u2014 Risque : <strong>'+Math.round(getTrialChance()*100)+'%</strong></div>';var bt=S.turn<S.maxTurns?'<button class="btn btn-primary" onclick="S.turn++;updateTopBar();startTurn()">Tour suivant \u2192</button>':'<button class="btn btn-primary" onclick="startQuiz()">Quiz final \u{1F4DD}</button>';document.getElementById('game-main').innerHTML='<div class="phase-card"><div class="phase-header"><span class="phase-icon">\u{1F4CA}</span><span class="phase-title">Bilan \u2014 '+getRomanYear()+'</span></div><p class="phase-text" style="text-align:center">'+(S.diff==='simple'?'Ce qui a chang\u00E9 :':'\u00C9volution cette ann\u00E9e :')+'</p><div class="summary-changes">'+ch+'</div>'+nr+w+'<div style="text-align:center;margin-top:1.5rem">'+bt+'</div></div>'}
function startQuiz(){var sh=QUIZ.slice().sort(function(){return Math.random()-.5});S.quizQs=sh.slice(0,5);S.quizIdx=0;S.quizScore=0;S.quizTotal=5;showQuizQ()}
function showQuizQ(){if(S.quizIdx>=S.quizQs.length){showEndScreen(false,true);return}var q=S.quizQs[S.quizIdx],os='';for(var i=0;i<q.o.length;i++)os+='<button class="quiz-option" onclick="answerQ('+i+')">'+q.o[i]+'</button>';document.getElementById('game-main').innerHTML='<div class="phase-card"><div class="phase-header"><span class="phase-icon">\u{1F4DD}</span><span class="phase-title">Quiz '+(S.quizIdx+1)+'/'+S.quizTotal+'</span></div><p class="phase-text" style="font-weight:bold;font-size:1.05rem">'+q.q+'</p><div id="qo">'+os+'</div><div id="qr" style="display:none"></div></div>'}
function answerQ(idx){var q=S.quizQs[S.quizIdx],ok=idx===q.c;if(ok)S.quizScore++;var b=document.querySelectorAll('#qo .quiz-option');for(var i=0;i<b.length;i++){b[i].disabled=true;if(i===q.c)b[i].classList.add('correct');if(i===idx&&!ok)b[i].classList.add('wrong')}var e=document.getElementById('qr');e.style.display='block';e.innerHTML='<div class="quiz-explanation">'+(ok?'\u2705 <strong>Correct !</strong>':'\u274C <strong>Incorrect.</strong>')+' '+gl(q.ex)+'</div><div style="text-align:center;margin-top:1rem"><button class="btn btn-primary btn-small" onclick="S.quizIdx++;showQuizQ()">Suivant \u2192</button></div>'}
function showEndScreen(vic,fq){var st=CURSUS.filter(function(s){return !s.plebeianOnly||S.origin==='plebeian'}),rk=st[S.cursusIdx]?st[S.cursusIdx].label:'Citoyen',ic=st[S.cursusIdx]&&st[S.cursusIdx].id==='consul',i,t,su,tx2;if(vic||ic){i='\u{1F3C6}';t='VICTORIA !';su='Consul';tx2='Magistrature supr\u00EAme !'+(S.corruptActions===0?' Sans aucune corruption !':' ('+S.corruptActions+' coup'+(S.corruptActions>1?'s':'')+' bas)');}else if(fq){if(S.quizScore>=4){i='\u{1F33F}';t='Fin honorable';su=rk;tx2='Quiz : '+S.quizScore+'/'+S.quizTotal+'. Solide !'}else if(S.quizScore>=2){i='\u{1F4DC}';t='Fin modeste';su=rk;tx2='Quiz : '+S.quizScore+'/'+S.quizTotal+'.'}else{i='\u{1F3DA}\uFE0F';t='Fin difficile';su=rk;tx2=S.quizScore+'/'+S.quizTotal+'. Retentez !'}}else if(S.gameOver){i='\u{1F480}';t='D\u00C9FAITE';su='Fin';tx2=S.defeatReason}else{i='\u{1F4DC}';t='Fin';su=rk;tx2='Rang : '+rk}var qs=S.quizTotal?'<div class="end-stat"><div class="end-stat-value">'+S.quizScore+'/'+S.quizTotal+'</div><div class="end-stat-label">Quiz</div></div>':'';document.getElementById('end-content').innerHTML='<div class="end-icon">'+i+'</div><h1 class="end-title">'+t+'</h1><p class="end-subtitle">'+su+'</p><p class="end-text">'+tx2+'</p><div class="end-stats"><div class="end-stat"><div class="end-stat-value">'+rk+'</div><div class="end-stat-label">Rang</div></div><div class="end-stat"><div class="end-stat-value">'+S.lawsVoted+'</div><div class="end-stat-label">Lois</div></div><div class="end-stat"><div class="end-stat-value">'+S.monsExplored+'</div><div class="end-stat-label">Monuments</div></div><div class="end-stat"><div class="end-stat-value">'+S.corruptActions+'</div><div class="end-stat-label">\u{1F40D} Coups bas</div></div><div class="end-stat"><div class="end-stat-value">'+S.trialsSurvived+'</div><div class="end-stat-label">\u2696\uFE0F Proc\u00E8s</div></div>'+qs+'</div><div style="display:flex;gap:1rem;justify-content:center;flex-wrap:wrap"><button class="btn btn-primary" onclick="resetGame()">\u{1F504} Rejouer</button><button class="btn" onclick="showRecap()">\u{1F4D6} R\u00E9capitulatif</button></div>';showScreen('end-screen')}
function resetGame(){S={origin:null,diff:S.diff,turn:1,maxTurns:8,gauges:{auctoritas:0,favor:0,pecunia:0,virtus:0,fortuna:50,corruptio:0},cursusIdx:0,visited:[],usedLaws:[],usedEvents:[],phase:'law',turnCh:{},lawsVoted:0,monsExplored:0,quizScore:0,quizTotal:0,gameOver:false,quizIdx:0,quizQs:[],trialsSurvived:0,corruptActions:0,shadyUsed:false};showScreen('origin-screen')}
function showRecap(){var vs=[];for(var i=0;i<MONUMENTS.length;i++)if(S.visited.indexOf(MONUMENTS[i].id)!==-1)vs.push(MONUMENTS[i]);var mh=vs.length?vs.map(function(m){return'<p><strong>'+m.icon+' '+m.name+'</strong> \u2014 '+m.pedagogy+'</p>'}).join(''):'<p><em>Aucun monument explor\u00E9.</em></p>';openModal('\u{1F4D6} R\u00E9capitulatif',gl('<h3>\u{1F3DB}\uFE0F Monuments ('+vs.length+'/'+MONUMENTS.length+')</h3>'+mh+'<h3 style="margin-top:1.5rem">\u2696\uFE0F Cursus honorum</h3><p>Questeur \u2192 \u00C9dile \u2192 Pr\u00E9teur \u2192 Consul. Pl\u00E9b\u00E9iens : Tribunat (veto).</p><h3>\u{1F40D} Corruption et justice</h3><p>Ambitus = achat de votes. Peculatus = d\u00E9tournement. Repetundae = extorsion. Jug\u00E9s par les quaestio perpetuae.</p><h3>\u{1F511} Notions</h3><p>SPQR \u2014 S\u00E9nat et Peuple romain. Pax deorum \u2014 Paix avec les dieux. Client\u00E8le \u2014 R\u00E9seau patron/clients.</p>')+'<div style="text-align:center;margin-top:1.5rem"><button class="btn btn-primary btn-small" onclick="closeModal()">Fermer</button></div>')}
function showHelp(){openModal('\u{1F4D6} R\u00E8gles',gl(
'<h3>\u{1F3AF} Objectif</h3><p>Gravir le cursus honorum pour atteindre le Consulat en 8 tours. '+(S.diff==='simple'?'Les mots soulign\u00E9s en pointill\u00E9s s\'expliquent au survol !':'Survolez les mots en pointill\u00E9s et les jauges pour comprendre.')+'</p>'+
'<h3>\u{1F3DB}\uFE0F Les \u00E9tapes et leurs conditions</h3>'+
'<table style="width:100%;border-collapse:collapse;margin:.8rem 0;font-size:.88rem"><tr style="background:var(--marble-dark);font-weight:bold"><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">Poste</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">R\u00F4le</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">Conditions</td></tr>'+
'<tr><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1);font-weight:bold">Citoyen</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">D\u00E9part</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">\u2014</td></tr>'+
'<tr><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1);font-weight:bold">Tribun*</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">Veto !</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">\u{1F465} Favor \u2265 50</td></tr>'+
'<tr><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1);font-weight:bold">Questeur</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">Finances</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">\u{1F3DB}\uFE0F \u2265 40, \u{1F3E6} \u2265 30</td></tr>'+
'<tr><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1);font-weight:bold">\u00C9dile</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">Jeux publics</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">\u{1F3DB}\uFE0F \u2265 50, \u{1F465} \u2265 45</td></tr>'+
'<tr><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1);font-weight:bold">Pr\u00E9teur</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">Justice</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">\u{1F3DB}\uFE0F \u2265 65, \u2694\uFE0F \u2265 45</td></tr>'+
'<tr style="background:rgba(212,168,67,0.08)"><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1);font-weight:bold;color:var(--gold-dark)">\u{1F3C6} Consul</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1)">Chef de Rome</td><td style="padding:.4rem .5rem;border:1px solid rgba(0,0,0,0.1);font-weight:bold">\u{1F3DB}\uFE0F \u2265 80, \u{1F465} \u2265 55, \u2694\uFE0F \u2265 55</td></tr></table>'+
'<p style="font-size:.82rem;font-style:italic">* Tribun = pl\u00E9b\u00E9iens seulement</p>'+
'<h3>\u{1F504} D\u00E9roulement</h3><p>1. Actions dans l\'ombre + Vote<br>2. Explorer Rome + Quiz<br>3. \u00C9v\u00E9nement<br>4. Proc\u00E8s (si corruptio \u00E9lev\u00E9e)<br>5. Promotion</p>'+
'<h3>\u{1F4DA} Aide</h3><p>Les <span class="gl">mots soulign\u00E9s<span class="glt">Comme celui-ci ! Survolez les mots en pointill\u00E9s pour voir leur d\u00E9finition.</span></span> s\'expliquent au survol. Cliquez \u00AB C\'est quoi ? \u00BB pour comprendre chaque d\u00E9cision.</p>'+
'<h3>\u26A0\uFE0F D\u00E9faites</h3><p>Pecunia = 0, Auct.+Favor tr\u00E8s bas, Fortuna = 0, ou exil.</p>')+'<div style="text-align:center;margin-top:1.5rem"><button class="btn btn-primary btn-small" onclick="closeModal()">Compris !</button></div>')}
</script></body></html>
